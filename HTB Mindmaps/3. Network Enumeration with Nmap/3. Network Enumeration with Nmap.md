# Network enumeration with Nmap

## Introduction to Nmap
### **Enumeration Overview**
- The primary goal is not just to gain access to the target system but to identify all possible attack vectors. 
- Tools used in enumeration are only as effective as the knowledge and attention to detail of the person using them. 
- The aim is to collect as much information as possible about the target.
- Scanning tools might miss details due to timeouts or specific configurations. 

### **Nmap Use Cases**
- Security audits
- Penetration testing
- Checking firewall and IDS configurations
- Network mapping
- Response analysis
- Vulnerability assessment

## Host Discovery
### Scan Network Range
- sudo nmap 10.129.2.0/24 -sn -oA tnet | grep for | cut -d" " -f5
### Scan IP List
- sudo nmap -sn -oA tnet -iL hosts.lst | grep for | cut -d" " -f5
### Scan Multiple IPs
- sudo nmap -sn -oA tnet 10.129.2.18 10.129.2.19 10.129.2.20| grep for | cut -d" " -f5
### Scan Single IP
- sudo nmap 10.129.2.18 -sn -oA host -PE --packet-trace 
- 10.129.2.18 Performs defined scans against the target.
- -sn Disables port scanning
- -oA host Stores the results in all formats starting with the name 'host'.
- -PE Performs the ping scan by using 'ICMP Echo requests' against the target.
- --packet-trace Shows all packets sent and received
## Port Scanning Techniques
#### **Privileges and Limitations**
- **Privileges Required**: Most port scanning techniques require privileged access because they involve sending and receiving raw packets. On Unix systems, this necessitates root access. On Windows, using an administrator account is recommended, although Nmap can sometimes function for unprivileged users if Npcap is preloaded.
- **Changing Landscape**: When Nmap was released in 1997, requiring root privileges was a significant limitation due to shared shell accounts. However, today, personal computers are more prevalent, and desktop Unix systems, including Linux and Mac OS X, are common. Nmap is also available for Windows, broadening its accessibility.

#### **Accuracy and Reliability**
- **Host Responses**: Nmap's results are based on the responses returned by the target machines or the firewalls in front of them. These responses can sometimes be misleading, especially with non-RFC-compliant hosts, which may not respond correctly to Nmap probes.
- **Scan Types and Susceptibility**: Certain scan types, such as FIN, NULL, and Xmas scans, are more susceptible to issues with non-compliant hosts. These problems are specific to certain scan techniques and are discussed within each type.

### **Specific Port Scanning Techniques**

#### **-sS (TCP SYN Scan)**
- **Default Scan**: The most popular scan option due to its speed and stealthiness. It scans thousands of ports per second on a fast network and is unobtrusive since it never completes TCP connections.
- **How It Works**: This scan sends a SYN packet as if to establish a connection. A SYN/ACK indicates an open port, while a RST signifies a closed port. If no response is received, the port is marked as filtered.

#### **-sT (TCP Connect Scan)**
- **Alternative to SYN Scan**: Used when SYN scan is not available, typically due to lack of privileges. It uses the operating system's connect system call to establish a connection.
- **Efficiency**: Less efficient than SYN scan as it completes the connection, which takes longer and is more likely to be logged by the target machine.

#### **-sU (UDP Scan)**
- **Targeting UDP Services**: Although UDP services are less common than TCP, they are still important and often overlooked. This scan sends a UDP packet to each targeted port.
- **Challenges**: UDP scanning is slower because many ports do not respond, requiring Nmap to time out and retry.

#### **-sY (SCTP INIT Scan)**
- **SCTP Protocol**: SCTP is a newer protocol that combines features of TCP and UDP. This scan is similar to the SYN scan but for SCTP, sending an INIT chunk to probe the target.
- **Stealth**: Like SYN scan, it is stealthy and does not complete the SCTP association, allowing for differentiation between open, closed, and filtered states.

#### **-sN; -sF; -sX (TCP NULL, FIN, and Xmas Scans)**
- **Exploit TCP Loophole**: These scans exploit a loophole in the TCP RFC to differentiate between open and closed ports. They work by sending packets with specific TCP flags and analyzing the response.
- **Stealth**: These scans are more stealthy than SYN scans but are less reliable against non-compliant systems, particularly Windows.

#### **-sA (TCP ACK Scan)**
- **Mapping Firewall Rules**: This scan is used to determine if a firewall is stateful and which ports are filtered. It sends an ACK packet and checks if a RST is returned.
- **Limitations**: This scan does not determine if ports are open, only whether they are filtered or unfiltered.

#### **-sW (TCP Window Scan)**
- **Variation of ACK Scan**: Similar to ACK scan but examines the TCP window field in returned RST packets to differentiate between open and closed ports.
- **Reliability**: Only works on a minority of systems, so results should be interpreted cautiously.

#### **-sM (TCP Maimon Scan)**
- **Similar to NULL, FIN, and Xmas Scans**: Uses a FIN/ACK probe to exploit a TCP loophole. Some systems drop the packet if the port is open, allowing Nmap to identify it as such.

#### **--scanflags (Custom TCP Scan)**
- **Design Your Scan**: Allows advanced users to specify custom TCP flags for their scan. This can be used to evade IDS systems by crafting unique scan packets.

#### **-sZ (SCTP COOKIE ECHO Scan)**
- **Advanced SCTP Scan**: Takes advantage of the SCTP COOKIE ECHO chunk to identify open or filtered ports. Less obvious than an INIT scan but still detectable by a good IDS.

#### **-sI "zombie host"["probeport"] (Idle Scan)**
- **Blind TCP Scan**: Uses a side-channel attack on a zombie host to scan the target without sending packets from your real IP address. It is extraordinarily stealthy but requires a suitable zombie host.

#### **-sO (IP Protocol Scan)**
- **Scanning IP Protocols**: Determines which IP protocols are supported by the target. Instead of scanning ports, it iterates through IP protocol numbers, looking for responses.

#### **-b "FTP relay host" (FTP Bounce Scan)**
- **Exploiting FTP Protocol**: Takes advantage of the FTP protocol's proxy feature to scan other hosts. This method is largely outdated but still useful in certain cases.

## Target Specification

#### **IP or Hostname**
- **Basic Input**: Anything that isn’t an option in the Nmap command-line is treated as a target specification, such as an IP address or hostname.
- **Hostname Resolution**: Hostnames are resolved via DNS to an IP address. By default, only the first resolved IP is scanned. Use `--resolve-all` to scan all resolved addresses.

#### **CIDR Notation**
- **Network Range Scanning**: Supports CIDR-style addressing to scan a network. For example, `192.168.10.0/24` scans all 256 hosts within that subnet.
- **Usage Example**: Scanning `scanme.nmap.org/16` would cover 65,536 IP addresses from `64.13.0.0` to `64.13.255.255`.

#### **Octet Range Addressing**
- **Flexible Targeting**: Allows specifying ranges within IP octets, such as `192.168.0-255.1-254` to exclude addresses ending in `.0` or `.255`.
- **Advanced Usage**: Can be used to scan a broad range of addresses or specific patterns, like `0-255.0-255.13.37` for an Internet-wide scan.

#### **IPv6 Addressing**
- **Support for IPv6**: Can specify fully qualified IPv6 addresses or use CIDR notation for subnets. Octet ranges are not supported for IPv6.
- **Zone ID Suffix**: For non-global IPv6 addresses, include a zone ID (e.g., `fe80::a8bb:ccff:fedd:eeff%eth0`).

### **Target Selection Options**

#### **-iL (Input from List)**
- **File Input**: Reads target specifications from a specified file, useful for scanning large lists of hosts.
- **Comment Support**: The input file can include comments starting with `#`.

#### **-iR (Choose Random Targets)**
- **Random Scanning**: Generates a specified number of random IPs to scan, skipping undesirable IPs like private or unallocated addresses.
- **Usage Scenario**: Useful for Internet-wide surveys or research.

#### **--exclude / --excludefile**
- **Exclude Targets**: Use `--exclude` for a comma-separated list or `--excludefile` to specify a file with excluded targets.
- **Usage**: Helps avoid scanning critical servers or networks you want to leave untouched.

#### **-n (No DNS Resolution)**
- **Speed Optimization**: Disables reverse DNS resolution, which can significantly reduce scanning time.

#### **-R (DNS Resolution for All Targets)**
- **Forces DNS Resolution**: Ensures that reverse DNS is performed for all targets, not just responsive ones.

#### **--resolve-all (Scan Each Resolved Address)**
- **Scan Multiple Resolved Addresses**: When a hostname resolves to multiple IPs, this option ensures all are scanned, not just the first one.

#### **--unique (Scan Each Address Only Once)**
- **Avoid Duplicate Scans**: Ensures each IP address is scanned only once, even if listed multiple times due to overlapping ranges.

#### **--system-dns (Use System DNS Resolver)**
- **Alternative DNS Resolution**: Uses the system's DNS resolver instead of Nmap's built-in parallel resolver. This can be slower and is rarely necessary.

#### **--dns-servers (Specify DNS Servers)**
- **Custom DNS Servers**: Specifies alternate DNS servers for reverse DNS queries, which can improve speed and stealth in certain scenarios.
- **Private Networks**: Especially useful when scanning private networks where specific name servers may be needed for proper DNS resolution.
## Host Discovery
#### **Purpose of Host Discovery**
- **Initial Step**: The first task in network reconnaissance is to identify active or interesting hosts within a set of IP ranges, which is crucial for efficient scanning.
- **Customization**: Nmap offers a wide range of options to tailor host discovery to specific needs, from simple ICMP pings to complex multi-port TCP, UDP, and SCTP probes.

#### **Default Behavior**
- **Standard Probes**: If no specific host discovery options are provided, Nmap sends an ICMP echo request, a TCP SYN to port 443, a TCP ACK to port 80, and an ICMP timestamp request. For local networks, ARP (for IPv4) or Neighbor Discovery (for IPv6) scans are used.
- **Unprivileged Users**: Default probes for unprivileged Unix users include SYN packets to ports 80 and 443 using the connect system call.

#### **Key Options for Host Discovery**

- **-sL (List Scan)**
  - **Listing Without Probing**: Generates a list of hosts within a specified network without sending any packets. Reverse DNS resolution is performed by default.
  - **Usage**: Useful for sanity checks to ensure accurate IP address targeting.

- **-sn (No Port Scan)**
  - **Ping Scan**: Performs host discovery without port scanning, listing only the hosts that respond to probes.
  - **Flexibility**: Can be combined with other discovery probe types (-P* options) for more comprehensive scanning.

- **-Pn (No Ping)**
  - **Skipping Host Discovery**: Disables host discovery, causing Nmap to perform all requested scanning functions against every target IP address specified, regardless of their status.
  - **ARP Scanning**: For local networks, ARP scanning is still performed unless explicitly disabled.

- **-PS (TCP SYN Ping)**
  - **SYN Probing**: Sends a TCP SYN packet to specified ports to check for active hosts. It detects availability through RST or SYN/ACK responses.
  - **Usage**: Effective for bypassing certain firewalls that block standard ICMP pings.

- **-PA (TCP ACK Ping)**
  - **ACK Probing**: Sends a TCP ACK packet, prompting a RST response from active hosts, useful for evading firewalls that block SYN packets.
  - **Firewall Evasion**: Combined with SYN probes (-PS) to increase the chances of bypassing firewalls.

- **-PU (UDP Ping)**
  - **UDP Probing**: Sends a UDP packet to specified ports, relying on ICMP port unreachable messages to detect active hosts.
  - **Firewall Bypass**: Useful for evading firewalls that block TCP packets.

- **-PY (SCTP INIT Ping)**
  - **SCTP Probing**: Sends an SCTP INIT chunk to establish whether a host is active, responding with either an INIT-ACK or an ABORT chunk.
  - **Advanced Protocol**: SCTP is a less common but robust alternative to TCP and UDP, often used in specialized applications.

- **-PE; -PP; -PM (ICMP Ping Types)**
  - **Standard ICMP Pings**: Sends ICMP echo, timestamp, or address mask requests to detect active hosts. 
  - **Internal Networks**: Particularly useful for administrators monitoring internal networks, though less effective against hosts that block ICMP requests.

- **-PO (IP Protocol Ping)**
  - **Protocol Probing**: Sends IP packets with specified protocol numbers (e.g., ICMP, IGMP) to detect active hosts through protocol-specific responses.
  - **Versatile**: Useful when other ping methods fail due to protocol filtering.

#### **Additional Host Discovery Options**

- **--disable-arp-ping (No ARP or ND Ping)**
  - **Disabling Local Discovery**: Prevents ARP or Neighbor Discovery on local networks, useful in environments with proxy ARP.

- **--discovery-ignore-rst**
  - **Ignoring Spoofed RSTs**: Ignores TCP RST replies during discovery to avoid false positives caused by firewalls spoofing these responses.

- **--traceroute (Trace Path to Host)**
  - **Post-Scan Tracing**: Performs traceroute after scanning, using scan results to optimize path tracing to the target, reducing the number of packets needed.

These options and techniques provide a flexible and powerful approach to host discovery, allowing for efficient and thorough network reconnaissance tailored to the specific needs of the user.
## Port Scanning Basics
#### **Open**
- **Description**: Indicates that an application is actively accepting connections, datagrams, or associations on the port.
- **Significance**: Open ports are primary targets for attackers and pen-testers, as they represent potential entry points. Administrators aim to secure these ports without disrupting legitimate services.

#### **Closed**
- **Description**: The port is accessible but has no active application listening on it.
- **Significance**: Closed ports confirm that a host is active on an IP address and can be useful in host discovery and OS detection. They may become open later, so periodic rescanning can be beneficial. Administrators may opt to block these ports with a firewall, transitioning them to the filtered state.

#### **Filtered**
- **Description**: Nmap cannot determine whether the port is open due to packet filtering, which blocks the probes.
- **Significance**: Filtered ports provide minimal information, frustrating attackers. Probes might be dropped silently or result in ICMP error messages, which significantly slows down scanning.

#### **Unfiltered**
- **Description**: The port is accessible, but Nmap cannot determine whether it is open or closed.
- **Significance**: This state is identified using the ACK scan and suggests that further scans (like SYN or FIN scans) may be needed to clarify the port's status.

#### **Open|Filtered**
- **Description**: Nmap cannot definitively determine whether the port is open or filtered because open ports in certain scans (e.g., UDP, IP protocol, FIN, NULL, Xmas scans) do not respond.
- **Significance**: This state indicates ambiguity, as the lack of response could be due to an open port or a filter that blocks the response.

#### **Closed|Filtered**
- **Description**: Nmap cannot determine whether a port is closed or filtered.
- **Significance**: This state is specific to the IP ID idle scan and indicates uncertainty about whether the port is closed or simply filtered.

## Port Specification and Scan Order
#### **-p "port ranges" (Only scan specified ports)**
- **Description**: Specifies which ports to scan, overriding the default of the most common 1,000 ports.
- **Syntax**: You can list individual port numbers or ranges (e.g., 1-1023). Use `-p-` to scan all ports from 1 through 65535.
- **Protocol Specification**: Prefix ports with `T:` for TCP, `U:` for UDP, `S:` for SCTP, or `P:` for IP Protocol when scanning multiple protocols.
- **Port Naming**: Ports can also be specified by name (e.g., `ftp`, `http*`) based on the `nmap-services` file.
#### **--exclude-ports "port ranges" (Exclude specified ports from scanning)**
- **Description**: Excludes specific ports from being scanned. Ports are excluded from all scan types, including the discovery phase.
- **Syntax**: Similar to the `-p` option for specifying ranges or individual ports.

#### **-F (Fast Scan)**
- **Description**: Scans a smaller subset of ports (100) instead of the default 1,000.
- **Use Case**: Useful for quick scans when you need a faster overview of the most common ports.

#### **-r (Don't randomize ports)**
- **Description**: Disables randomization of port scanning order, scanning ports sequentially from lowest to highest.
- **Use Case**: Sequential scanning can be useful for certain types of analysis or when randomization is undesirable.

#### **--port-ratio "ratio" (Scan ports based on frequency)**
- **Description**: Scans all ports in the `nmap-services` file with a frequency ratio greater than the specified value. The ratio must be between 0.0 and 1.0.

#### **--top-ports "n" (Scan top N ports)**
- **Description**: Scans the top `n` ports based on their frequency ratio in the `nmap-services` file. This excludes any ports specified by the `--exclude-ports` option.
- **Use Case**: Efficient for scanning the most commonly used ports without scanning unnecessary ones.
## Service and Version Detection
#### **Purpose of Version Detection**
- **Basic Identification**: When Nmap identifies open ports (e.g., 25/tcp, 80/tcp, 53/udp), it can infer common services like SMTP, HTTP, and DNS using its `nmap-services` database. However, this basic identification might not always be accurate or sufficient for security assessments.
- **Detailed Information**: Version detection goes beyond just identifying open ports. It attempts to determine the service protocol (e.g., FTP, HTTP), application name (e.g., Apache httpd), version number, OS family, and even specific details like SSH protocol version or whether an X server is open to connections.
- **SSL Support**: If compiled with OpenSSL, Nmap can probe SSL servers to identify the services running behind the encryption.

#### **Functionality of Version Detection**
- **Service Probes**: After discovering open ports, Nmap uses probes from its `nmap-service-probes` database to interact with these services and determine detailed information.
- **Handling open|filtered Ports**: For ports in the open|filtered state (where it's unclear if the port is open or filtered), version detection tries to elicit a response to confirm the port's status.
- **RPC Services**: Nmap includes an RPC grinder that automatically attempts to identify RPC program and version numbers for any detected RPC services.
- **Unmatched Responses**: If Nmap receives responses it can't identify, it provides a fingerprint and encourages users to submit it for future database updates.

#### **Version Detection Options**
- **-sV (Version Detection)**
  - **Enables Version Detection**: Activates the version detection process to gather detailed service information.
  - **Alias**: `-sR` is an alias for `-sV`, though they are now combined.
  
- **--allports (Scan All Ports)**
  - **Overrides Exclusions**: Ensures that all ports, even those typically excluded (like TCP port 9100), are included in the version scan.

- **--version-intensity "intensity" (Set Scan Intensity)**
  - **Controls Probes**: Sets the intensity level (0-9) for how aggressively Nmap should probe services. Higher levels increase accuracy but take longer.
  - **Default**: The default intensity is 7.

- **--version-light (Light Mode)**
  - **Faster Scans**: Equivalent to `--version-intensity 2`, this mode is faster but may miss some service identifications.

- **--version-all (Try All Probes)**
  - **Max Intensity**: Equivalent to `--version-intensity 9`, this option ensures that every available probe is used.

- **--version-trace (Trace Scan Activity)**
  - **Debugging Information**: Provides detailed output about what the version scan is doing, useful for troubleshooting and understanding scan behavior.

## OS Detection
#### **OS Detection Process**
- **TCP/IP Stack Fingerprinting**: Nmap sends multiple TCP and UDP packets to the target and examines the responses. It conducts tests like TCP ISN sampling, TCP options support, IP ID sampling, and initial window size checks.
- **Fingerprint Matching**: The results are compared to the `nmap-os-db` database, which contains over 2,600 OS fingerprints. Each match includes details like the OS vendor, version, device type, and a Common Platform Enumeration (CPE) representation.
- **Contribution to the Database**: If Nmap can't identify the OS but conditions are favorable (e.g., at least one open and one closed port), it provides a URL for users to submit the unknown fingerprint, improving Nmap's accuracy for future scans.

#### **Additional Features Enabled by OS Detection**
- **TCP Sequence Predictability Classification**: Assesses the difficulty of forging TCP connections to the target, which can be useful for exploiting source-IP based trust relationships or hiding attack sources. This information is reported in verbose mode.
- **IP ID Sequence Generation**: Reports how the target generates IP ID sequences, which can reveal vulnerabilities to certain attacks. Most machines fall into the "incremental" class, making them susceptible to advanced information gathering and spoofing attacks.
- **Uptime Guess**: Estimates how long the target has been running since its last reboot using the TCP timestamp option. This guess is only shown in verbose mode and may not always be accurate.

#### **OS Detection Options**
- **-O (Enable OS Detection)**
  - **Basic Command**: Activates OS detection.
  - **Alternative**: The `-A` option also enables OS detection along with additional features.

- **--osscan-limit (Limit OS Detection to Promising Targets)**
  - **Efficiency**: Nmap only attempts OS detection on hosts with at least one open and one closed TCP port, improving scan efficiency.

- **--osscan-guess; --fuzzy (Guess OS Detection Results)**
  - **Aggressive Guessing**: If Nmap can't find a perfect match, it suggests near-matches with a confidence level. These options make Nmap guess more aggressively.

- **--max-os-tries (Set Maximum OS Detection Attempts)**
  - **Retry Control**: Sets how many times Nmap will retry OS detection if it doesn't find a match. The default is five retries under good conditions and two retries otherwise. Adjusting this value can speed up scans or increase accuracy for fingerprint submissions.
## Nmap Scripting Engine (NSE)
#### **Script Categories**
- `auth`
- `broadcast`
- `default`
- `discovery`
- `dos`
- `exploit`
- `fuzzer`
- `intrusive`
- `malware`
- `safe`
- `version`
- `vuln`

#### **Important NSE Options**
- **-sC (Default Script Scan)**
  - **Functionality**: Executes a script scan using the default set of scripts. Equivalent to `--script=default`. Note that some scripts in this category may be intrusive and should be used with caution.

- **--script `<filename>|<category>|<directory>|<expression>`**
  - **Functionality**: Allows users to specify scripts to run, either by filename, category, directory, or Boolean expressions. Advanced users can force scripts to run or select all scripts using special features.
  - **Examples**:
    - `nmap --script "http-*"`: Runs all scripts starting with `http-`.
    - `nmap --script "default or safe"`: Runs scripts in the `default` or `safe` categories.

- **--script-args `<name=value>`**
  - **Functionality**: Passes arguments to NSE scripts. Arguments are specified as a comma-separated list of `name=value` pairs. These can include strings or Lua tables.
  - **Example**: `--script-args 'user=foo,pass=bar'`

- **--script-args-file `<filename>`**
  - **Functionality**: Loads script arguments from a file. Command-line arguments will override those in the file. This option simplifies managing complex or large sets of arguments.

- **--script-help `<filename>|<category>|<directory>|<expression>|all`**
  - **Functionality**: Provides detailed information about scripts, including their names, categories, and descriptions. Useful for previewing scripts that will be executed.

- **--script-trace**
  - **Functionality**: Displays all communication performed by scripts, including protocol, source, target, and transmitted data. This is helpful for debugging and understanding script behavior.

- **--script-updatedb**
  - **Functionality**: Updates the script database, necessary if scripts are added, removed, or categories are modified. This ensures Nmap recognizes the available scripts and their categories.



## Firewall/IDS Evasion and Spoofing

#### **Packet Fragmentation**
- **Option**: `-f` or `--mtu <value>`
- **Functionality**: Splits IP packets into smaller fragments to make them harder for firewalls and IDS to detect. By default, Nmap fragments packets into segments of eight bytes. The `--mtu` option allows users to specify a custom fragment size.

#### **Decoy Scanning**
- **Option**: `-D <decoy1>[,<decoy2>][,ME][,...]`
- **Functionality**: Uses decoy IP addresses alongside the real one to confuse IDS/IPS systems, making it difficult to determine the actual scanning source.

#### **Source Address Spoofing**
- **Option**: `-S <IP_Address>`
- **Functionality**: Allows users to spoof the source IP address, making it appear as though the scan is coming from a different IP. This is useful for simulating scans from an unauthorized source.

#### **Interface Specification**
- **Option**: `-e <interface>`
- **Functionality**: Specifies which network interface Nmap should use for sending and receiving packets, useful when multiple interfaces are available.

#### **Source Port Spoofing**
- **Option**: `--source-port <portnumber>` or `-g <portnumber>`
- **Functionality**: Spoofs the source port number of packets to exploit common firewall misconfigurations that trust traffic based on source port.

#### **Custom Data Payloads**
- **Options**:
  - `--data <hex string>`: Appends custom binary data to packets.
  - `--data-string <string>`: Appends a custom string to packets.
  - `--data-length <number>`: Appends a specified number of random bytes to packets.
- **Functionality**: These options allow for the customization of packet payloads, potentially bypassing filters that rely on specific packet structures.

#### **IP Options**
- **Option**: `--ip-options <R|S [route]|L [route]|T|U ...>` or `--ip-options <hex string>`
- **Functionality**: Adds specific IP options to packets, such as record route or source routing, which can manipulate the network path or gather route information.

#### **TTL Manipulation**
- **Option**: `--ttl <value>`
- **Functionality**: Sets the IP time-to-live (TTL) value, which can be useful in evading detection or manipulating packet routes.

#### **Host Randomization**
- **Option**: `--randomize-hosts`
- **Functionality**: Randomizes the order of target hosts to make scans less predictable and harder to detect.

#### **MAC Address Spoofing**
- **Option**: `--spoof-mac <MAC address, prefix, or vendor name>`
- **Functionality**: Spoofs the MAC address of the scanning system to avoid detection or to impersonate another device.

#### **Proxy Scanning**
- **Option**: `--proxies <Comma-separated list of proxy URLs>`
- **Functionality**: Routes TCP connections through a chain of HTTP or SOCKS4 proxies, useful for hiding the true source of a scan or evading firewall restrictions.

#### **Bogus Checksum**
- **Option**: `--badsum`
- **Functionality**: Sends packets with invalid TCP/UDP checksums, which can trick poorly configured firewalls or IDS into responding, revealing their presence.

#### **Deprecated SCTP Checksum**
- **Option**: `--adler32`
- **Functionality**: Uses the deprecated Adler32 algorithm instead of CRC-32C for SCTP checksums, potentially evading older SCTP implementations.

## Output Options
#### **Output Formats**

- **Normal Output (`-oN <filespec>`)**
  - Directs standard output to a specified file, offering a concise summary of scan results.

- **XML Output (`-oX <filespec>`)**
  - Saves scan results in XML format, ideal for software parsing, and compatible with various tools and browsers. XML output can be transformed into HTML using an XSL stylesheet.

- **Script Kiddie Output (`-oS <filespec>`)**
  - A humorous format designed to mimic the style preferred by novice hackers, offering the same data as normal output but with altered formatting.

- **Grepable Output (`-oG <filespec>`)**
  - Outputs scan results in a simple, grep-friendly format, placing each host’s information on a single line. Deprecated in favor of XML due to limitations in supporting new Nmap features.

- **All Formats (`-oA <basename>`)**
  - Saves results in normal, XML, and grepable formats simultaneously, using a shared base filename.

#### **Verbosity and Debugging**

- **Increase Verbosity (`-v`, `-v<level>`)**
  - Increases the amount of information printed during a scan, showing open ports as they are found and providing time estimates for long scans.

- **Increase Debugging (`-d`, `-d<level>`)**
  - Provides detailed debugging output, useful for diagnosing issues with scans or understanding Nmap's internal processes.

- **Show Reasons (`--reason`)**
  - Displays the reasons behind Nmap's determination of port and host states, such as specific packet types received.

- **Periodic Stats (`--stats-every <time>`)**
  - Prints periodic timing statistics during long scans, helpful for monitoring progress.

- **Packet Trace (`--packet-trace`)**
  - Outputs a summary of every packet sent and received, useful for debugging and learning how Nmap operates under the hood.

- **Show Only Open Ports (`--open`)**
  - Filters results to display only open or potentially open ports, reducing clutter from closed or filtered ports.

- **List Interfaces and Routes (`--iflist`)**
  - Prints a list of detected network interfaces and routes, aiding in troubleshooting network-related issues.

#### **Miscellaneous Options**

- **Append Output (`--append-output`)**
  - Adds new scan results to an existing file rather than overwriting it, preserving previous data.

- **Resume Scan (`--resume <filename>`)**
  - Resumes a scan from where it left off, using the specified output file, which is particularly useful for lengthy scans.

- **Disable Runtime Interactions (`--noninteractive`)**
  - Prevents Nmap from responding to keyboard input during a scan, useful for background processes.

- **Set XSL Stylesheet (`--stylesheet <path or URL>`)**
  - Associates a specific XSL stylesheet with XML output for easier viewing in browsers or conversion to HTML.

- **Load Web Stylesheet (`--webxml`)**
  - A shortcut for loading the latest XSL stylesheet from Nmap.org for use with XML output.

- **No Stylesheet (`--no-stylesheet`)**
  - Omits the XSL stylesheet declaration from XML output, for cases where HTML conversion is not needed.

## Miscellaneous Options

- **Enable IPv6 Scanning (`-6`)**
  - Supports IPv6 for ping scanning, port scanning, version detection, and scripting. Requires both the source and target to be configured for IPv6.

- **Aggressive Scan (`-A`)**
  - Enables OS detection, version scanning, script scanning, and traceroute. It combines advanced options for a comprehensive scan but should only be used with permission due to the intrusive nature of some scripts.

- **Custom Data Directory (`--datadir <directoryname>`)**
  - Specifies a custom location for Nmap's data files, such as service probes and OS fingerprints. This overrides default file locations.

- **Custom Services File (`--servicedb <services file>`)**
  - Uses a specified services file instead of the default `nmap-services` file, typically used for custom service definitions.

- **Custom Service Probes File (`--versiondb <service probes file>`)**
  - Uses a specified service probes file instead of the default `nmap-service-probes`, useful for customized service detection.

- **Send Raw Ethernet (`--send-eth`)**
  - Sends packets at the raw ethernet layer rather than the IP layer. Typically used on Windows where raw socket support is limited.

- **Send Raw IP (`--send-ip`)**
  - Sends packets via raw IP sockets, as a complement to `--send-eth`. Generally used on Unix systems.

- **Assume Privileges (`--privileged`)**
  - Forces Nmap to assume the user has sufficient privileges to perform raw socket operations, even if the user ID check fails. Useful for environments with specific privilege configurations.

- **Assume No Privileges (`--unprivileged`)**
  - Opposite of `--privileged`, forcing Nmap to act as if the user lacks raw socket privileges. Useful for testing or troubleshooting.

- **Release Memory (`--release-memory`)**
  - Releases allocated memory before Nmap quits, helpful for debugging memory leaks.

- **Print Version (`-V`, `--version`)**
  - Displays the current version of Nmap and exits.

- **Print Help (`-h`, `--help`)**
  - Displays a help summary with common command flags. Running Nmap without arguments will also display this help.

## Runtime Interaction

- **Increase/Decrease Verbosity (`v` / `V`)**
  - Press `v` to increase the verbosity level, showing more detailed output. Press `V` to decrease verbosity.

- **Increase/Decrease Debugging (`d` / `D`)**
  - Press `d` to increase the debugging level for more in-depth information. Press `D` to decrease it.

- **Toggle Packet Tracing (`p` / `P`)**
  - Press `p` to turn on packet tracing, showing the packets being sent and received. Press `P` to turn it off.

- **Help Screen (`?`)**
  - Press `?` to display a help screen with a summary of available runtime interaction commands.

## Timing and Performance

#### **--min-hostgroup "numhosts"; --max-hostgroup "numhosts"**
- **Adjust Parallel Scan Group Sizes**: Controls the number of hosts scanned in parallel. Larger groups increase efficiency but delay individual host results. Defaults vary depending on the scan type.

#### **--min-parallelism "numprobes"; --max-parallelism "numprobes"**
- **Adjust Probe Parallelization**: Sets the number of probes sent concurrently. Increasing this can speed up scans but may reduce accuracy on unreliable networks.

#### **--min-rtt-timeout "time"; --max-rtt-timeout "time"; --initial-rtt-timeout "time"**
- **Adjust Probe Timeouts**: Controls how long Nmap waits for probe responses. Tuning these values can significantly reduce scan times, especially on reliable networks.

#### **--max-retries "numtries"**
- **Limit Probe Retransmissions**: Restricts the number of retries when no response is received. Reducing retries speeds up scans but may miss some open ports.

#### **--host-timeout "time"**
- **Abort Slow Hosts**: Skips hosts that take longer than the specified time to scan. Useful for avoiding time-consuming hosts.

#### **--script-timeout "time"**
- **Limit Script Execution Time**: Sets a maximum duration for each script to run. Helps prevent long-running scripts from delaying the scan.

#### **--scan-delay "time"; --max-scan-delay "time"**
- **Adjust Delay Between Probes**: Controls the delay between probes sent to a host. Useful for managing rate limits and evading IDS/IPS.

#### **--min-rate "number"; --max-rate "number"**
- **Control Scanning Rate**: Directly sets the minimum or maximum packet rate for the scan. Useful for ensuring scans complete within a specific time frame.

#### **--defeat-rst-ratelimit**
- **Ignore RST Rate Limits**: Speeds up scans by not waiting for rate-limited RST responses. This may reduce accuracy in detecting closed ports.

#### **--defeat-icmp-ratelimit**
- **Ignore ICMP Rate Limits**: Similar to RST, this option speeds up UDP scans by not waiting for rate-limited ICMP responses, potentially reducing accuracy.

#### **--nsock-engine iocp|epoll|kqueue|poll|select**
- **Choose IO Multiplexing Engine**: Forces Nmap to use a specific IO engine, which can affect performance depending on the platform.

#### **-T paranoid|sneaky|polite|normal|aggressive|insane**
- **Set a Timing Template**: Predefined templates that adjust timing parameters for different scenarios, ranging from stealthy (paranoid) to fast (insane). 

These options provide flexibility in tuning Nmap scans, making them adaptable to various network environments and performance requirements.