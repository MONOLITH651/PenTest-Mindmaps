---

mindmap-plugin: basic

---
# Host Based Footprinting
## FTP
- General
	- TCP/21 control channel
	- TCP/20 data channel
	- cleartext protocol
	- Commands https://www.smartfile.com/blog/the-ultimate-ftp-commands-list
	- Status Codes https://en.wikipedia.org/wiki/List_of_FTP_server_return_codes
- TFTP
	- Trivial FTP
	- File Transfers between client and server processes
	- No authentication
	- uses UDP - unreliable
	- unlike the FTP client, TFTP does not have directory listing functionality.
- Default configurations
	- Location: cat /etc/vsftpd.conf | grep -v "#"
	- listen: NO - Run from inetd or as a standalone daemon?
	- listen_ipv6: YES - Listen on IPv6?
	- anonymous_enable: NO - Enable Anonymous access?
	- local_enable: YES - Allow local users to login?
	- dirmessage_enable: YES - Display active directory messages when users go into certain directories?
	- use_localtime: YES - Use local time?
	- xferlog_enable: YES - Activate logging of uploads/downloads?
	- connect_from_port_20: YES - Connect from port 20?
	- secure_chroot_dir: /var/run/vsftpd/empty - Name of an empty directory.
	- pam_service_name: vsftpd - This string is the name of the PAM service vsftpd will use.
	- rsa_cert_file: /etc/ssl/certs/ssl-cert-snakeoil.pem - Specifies the location of the RSA certificate to use for SSL encrypted connections.
	- rsa_private_key_file: /etc/ssl/private/ssl-cert-snakeoil.key - Specifies the location of the RSA private key to use for SSL encrypted connections.
	- ssl_enable: NO - Enable SSL encryption?
- Dangerous Settings
	- anonymous_enable: YES - Allowing anonymous login?
	- anon_upload_enable: YES - Allowing anonymous to upload files?
	- anon_mkdir_write_enable: YES - Allowing anonymous to create new directories?
	- no_anon_password: YES - Do not ask anonymous for a password?
	- anon_root: /home/username/ftp - Directory for anonymous users.
	- write_enable: YES	- Allow the usage of FTP commands: STOR, DELE, RNFR, RNTO, MKD, RMD, APPE, and SITE?
- Footprinting the Service
	- sudo nmap -sV -p21 -sC -A 10.129.14.136
	- sudo nmap -sV -p21 -sC -A 10.129.14.136 --script-trace
	- nc -nv 10.129.14.136 21
	- telnet 10.129.14.136 21
	- openssl s_client -connect 10.129.14.136:21 -starttls ftp
## SMB
- General
	- TCP/445
	- Server Message Block (SMB)
	- Access rights are defined by Access Control Lists (ACL)
	- Commands
	- Samba
	- Alternative to SMB server for Unix-based OS but also Windows
	- Implements the Common Internet File System (CIFS) network protocol
- Default Configurations of Samba
	- Location: cat /etc/samba/smb.conf | grep -v "#\|\;" 
	- [sharename] - The name of the network share.
	- workgroup = WORKGROUP/DOMAIN - Workgroup that will appear when clients query.
	- path = /path/here/	- The directory to which the user is to be given access.
	- server string = STRING	- The string that will show up when a connection is initiated.
	- unix password sync = yes - Synchronize the UNIX password with the SMB password?
	- usershare allow guests = yes - Allow non-authenticated users to access the defined share?
	- map to guest = bad user - What to do when a user login request doesn't match a valid UNIX user?
	- browseable = yes - Should this share be shown in the list of available shares?
	- guest ok = yes - Allow connecting to the service without using a password?
	- read only = yes - Allow users to read files only?
	- create mask = 0700 - What permissions need to be set for newly created files?
- Dangerous Settings of Samba
	- browseable = yes - Allow listing available shares in the current share?
	- read only = no - Forbid the creation and modification of files?
	- writable = yes - Allow users to create and modify files?
	- guest ok = yes - Allow connecting to the service without using a password?
	- enable privileges = yes	- Honor privileges assigned to specific SID?
	- create mask = 0777 - What permissions must be assigned to the newly created files?
	- directory mask = 0777 - What permissions must be assigned to the newly created directories?
	- logon script = script.sh - What script needs to be executed on the user's login?
	- magic script = script.sh - Which script should be executed when the script gets closed?
	- magic output = script.out - Where the output of the magic script needs to be stored?
- Interaction
	- smbclient -N -L //10.129.14.128
	- smbclient //10.129.14.128/notes
- Footprinting
	- sudo nmap 10.129.14.128 -sV -sC -p139,445
	- rpcclient -U "" 10.129.14.128
	- samrdump.py 10.129.14.128
	- smbmap -H 10.129.14.128
	- crackmapexec smb 10.129.14.128 --shares -u '' -p ''
	- ./enum4linux-ng.py 10.129.14.128 -A
## NFS
- General
	- Network File System (NFS)
	- NFS is based on the Open Network Computing Remote Procedure Call (ONC-RPC/SUN-RPC) 
	- exposed on TCP and UDP ports 111
	- The NFS protocol has no mechanism for authentication or authorization
	- Authentication shifted to the RPC protocol's options
- Default Configuration
	- Location: cat /etc/exports 
	- rw - Read and write permissions.
	- ro - Read only permissions.
	- sync - Synchronous data transfer (A bit slower).
	- async - Asynchronous data transfer (A bit faster).
	- secure - Ports above 1024 will not be used.
	- insecure - Ports above 1024 will be used.
	- no_subtree_check - This option disables the checking of subdirectory trees.
	- root_squash - Assigns all permissions to files of root UID/GID 0 to the UID/GID of anonymous, which prevents root from accessing files on an NFS mount.
- Dangerous Settings
	- rw - Read and write permissions.
	- insecure - Ports above 1024 will be used.
	- nohide - If another file system was mounted below an exported directory, this directory is exported by its own exports entry.
	- no_root_squash - All files created by root are kept with the UID/GID 0.
- Footprinting
	- sudo nmap 10.129.14.128 -p111,2049 -sV -sC
	- sudo nmap --script nfs* 10.129.14.128 -sV -p111,2049
	- showmount -e 10.129.14.128
	- sudo mount -t nfs 10.129.14.128:/ ./target-NFS/ -o nolock
## DNS
- General
- Domain Name System (DNS)
- DNS is a system for resolving computer names into IP addresses, and it does not have a central database
- Types of DNS servers that are used worldwide:
	- DNS root server
		- Responsible for Top-level Domains TLD
		- ICANN coordinates the work of the root name server
		- 13 root servers around the globe
	- Authoritative name server
		- Hold authority for the particular zone
		- If cannot answer clients query, root name server takes over at this point
	- Non-authoritative name server
		- Not responsible for a particular DNS zone
		- Collect info on specific DNS zones themselves
		- Using Recursive and Iterative DNS querying
	- Caching server
		- Caching DNS servers cache information from other name servers for a specified period. 
		- The authoritative name server determines the duration of this storage.
	- Forwarding server
		- They forward DNS queries to another DNS server.
	- Resolver
		- Resolvers are not authoritative DNS servers 
	- Perform name resolution locally in the computer or router.
- Default Configuration for bind9
	- Local DNS configuration files
		- named.conf.local
		- named.conf.options 
		- named.conf.log 
	- Zone files
		- /etc/bind/db.domain.com
	- Reverse name resolution files
		- /etc/bind/db.10.129.14
- Dangerous Settings for bind9
	- allow-query - Defines which hosts are allowed to send requests to the DNS server.
	- allow-recursion - Defines which hosts are allowed to send recursive requests to the DNS server.
	- allow-transfer - Defines which hosts are allowed to receive zone transfers from the DNS server.
	- zone-statistics - Collects statistical data of zones.
- Footprinting
	- dig any inlanefreight.htb @10.129.14.128
	- dig axfr inlanefreight.htb @10.129.14.128
	- dnsenum --dnsserver 10.129.14.128 --enum -p 0 -s 0 -o subdomains.txt -f ./subdomains-top1million-110000.txt inlanefreight.htb
## SMTP
- General
	- Simple Mail Transfer Protocol (SMTP)
	- By default TCP/25, newer TCP/587
- Default Configuration
	- Location: cat /etc/postfix/main.cf | grep -v "#" | sed -r "/^\s*$/d"
	- AUTH PLAIN - AUTH is a service extension used to authenticate the client.
	- HELO - The client logs in with its computer name and thus starts the session.
	- MAIL FROM - The client names the email sender.
	- RCPT TO - The client names the email recipient.
	- DATA - The client initiates the transmission of the email.
	- RSET - The client aborts the initiated transmission but keeps the connection between client and server.
	- VRFY - The client checks if a mailbox is available for message transfer.
	- EXPN - The client also checks if a mailbox is available for messaging with this command.
	- NOOP - The client requests a response from the server to prevent disconnection due to time-out.
	- QUIT - The client terminates the session.
- Dangerous Settings
	- Open Relay Configuration
	- mynetworks = 0.0.0.0/0
	- this SMTP server can send fake emails and thus initialize communication between multiple parties.
- Footprinting
	- sudo nmap 10.129.14.128 -sC -sV -p25
	- sudo nmap 10.129.14.128 -p25 --script smtp-open-relay -v
	- telnet 10.129.14.128 25
## IMAP / POP3
- General
	- Internet Message Access Protocol (IMAP)
	- Post Office Protocol (POP3)
	- TCP/143, TCP/993
- IMAP Commands
	- 1 LOGIN username password - User's login.
	- 1 LIST "" * - Lists all directories.
	- 1 CREATE "INBOX"	- Creates a mailbox with a specified name.
	- 1 DELETE "INBOX"	- Deletes a mailbox.
	- 1 RENAME "ToRead" "Important" - Renames a mailbox.
	- 1 LSUB "" * - Returns a subset of names from the set of names that the user has declared as being active or subscribed.
	- 1 SELECT INBOX - Selects a mailbox so that messages in the mailbox can be accessed.
	- 1 UNSELECT INBOX - Exits the selected mailbox.
	- 1 FETCH ID all - Retrieves data associated with a message in the mailbox.
	- 1 CLOSE	- Removes all messages with the Deleted flag set.
	- 1 LOGOUT - Closes the connection with the IMAP server.
- POP3 Commands
	- USER username - Identifies the user.
	- PASS password - Authentication of the user using its password.
	- STAT - Requests the number of saved emails from the server.
	- LIST - Requests from the server the number and size of all emails.
	- RETR id - Requests the server to deliver the requested email by ID.
	- DELE id - Requests the server to delete the requested email by ID.
	- CAPA - Requests the server to display the server capabilities.
	- RSET - Requests the server to reset the transmitted information.
	- QUIT - Closes the connection with the POP3 server.
- Dangerous Settings
	- auth_debug - Enables all authentication debug logging.
	- auth_debug_passwords - This setting adjusts log verbosity; the submitted passwords and the scheme are logged.
	- auth_verbose - Logs unsuccessful authentication attempts and their reasons.
	- auth_verbose_passwords - Passwords used for authentication are logged and can also be truncated.
	- auth_anonymous_username - Specifies the username to be used when logging in with the ANONYMOUS SASL mechanism.
- Footprinting
	- sudo nmap 10.129.14.128 -sV -p110,143,993,995 -sC
	- curl -k 'imaps://10.129.14.128' --user user:p4ssw0rd
	- openssl s_client -connect 10.129.14.128:pop3s
	- openssl s_client -connect 10.129.14.128:imaps
## SNMP
- General
	- Simple Network Management Protocol (SNMP)
	- UDP/161, UDP 162
- Default Configurations
	- Location: cat /etc/snmp/snmpd.conf | grep -v "#" | sed -r '/^\s*$/d'
- Dangerous Settings
	- rwuser noauth - Provides access to the full OID tree without authentication.
	- rwcommunity community string IPv4 address - Provides access to the full OID tree regardless of where the requests were sent from.
	- rwcommunity6 community string IPv6 address - Same access as with rwcommunity, with the difference of using IPv6.
- Footprinting
	- snmpwalk -v2c -c public 10.129.14.128
	- onesixtyone -c /opt/useful/SecLists/Discovery/SNMP/snmp.txt 10.129.14.128
	- braa public@10.129.14.128:.1.3.6.*
## MySQL
- Default Configurations
	- Location: cat /etc/mysql/mysql.conf.d/mysqld.cnf | grep -v "#" | sed -r '/^\s*$/d'
- Dangerous Settings
	- user - Sets which user the MySQL service will run as.
	- password - Sets the password for the MySQL user.
	- admin_address - The IP address on which to listen for TCP/IP connections on the administrative network interface.
	- debug - This variable indicates the current debugging settings.
	- sql_warnings - This variable controls whether single-row INSERT statements produce an information string if warnings occur.
	- secure_file_priv - This variable is used to limit the effect of data import and export operations.
- Footprinting
	- sudo nmap 10.129.14.128 -sV -sC -p3306 --script mysql*
	- mysql -u root -h 10.129.14.132
## MSSQL
- General
	- Microsoft SQL (MSSQL)
- Interaction
	- mssql-cli
	- SQL Server PowerShell
	- HeidiSQL
	- SQLPro
	- Impacket's mssqlclient.py
## IPMI
- General
	- Intelligent Platform Management Interface (IPMI)
	- Standardized specifications for hardware-based host management systems
	- Used for system management and monitoring
	- UDP/623
- Footprinting
	- sudo nmap -sU --script ipmi-version -p 623 ilo.inlanfreight.local
## Enumeration Layers
- Internet Presence
	- Goal: identify all possible target systems and interfaces that can be tested
	- Domains
	- Subdomains
	- vHosts
	- ASN
	- Netblocks
	- IP Addresses
	- Cloud Infrastructure
	- Security Measures
- Gateway
	- Goal: understand what we are dealing with and what we have to watch out for
	- Firewalls
	- DMZ
	- IPS/IDS
	- EDR
	- Proxies
	- NAC
	- Network Segmentaion
	- VPN
	- Cloudflare
- Accessible Services
	- Goal: understand the reason and functionality of the target system, communicate with it, exploit it
	- Service Type
	- Functionality
	- Configuration
	- Port
	- Version
	- Interface
- Processes
	- Goal: understand these factors and identify the dependencies between them.
	- PID
	- Processed Data
	- Tasks
	- Source
	- Destination
- Privileges
	- Goal: identify these and understand what is and is not possible with these privileges
	- Groups
	- Users
	- Permissions
	- Restrictions
	- Environment
- OS Setup
	- Goal: see how the administrators manage the systems and what sensitive internal information we can glean from them.
	- OS Type
	- Patch Level
	- Network config
	- OS Environment
	- Config Files
	- Sensitive Private Files
## SSH
- Default Configuration
	- cat /etc/ssh/sshd_config  | grep -v "#" | sed -r '/^\s*$/d'
	- PasswordAuthentication yes
	    - Allows password-based authentication.
	- PermitEmptyPasswords yes
	    - Allows the use of empty passwords.
	- PermitRootLogin yes
	    - Allows logging in as the root user.
	- Protocol 1
	    - Uses an outdated version of encryption.
	- X11Forwarding yes
	    - Allows X11 forwarding for GUI applications.
	- AllowTcpForwarding yes
	    - Allows forwarding of TCP ports.
	- PermitTunnel
	    - Allows tunneling.
	- DebianBanner yes
	    - Displays a specific banner when logging in.
- Footprinting
	- ./ssh-audit.py 10.129.14.132
	- rsync -av --list-only rsync://127.0.0.1/dev
## Rsync
- General
	- Rsync is a fast and efficient tool for locally and remotely copying files.
	- TCP/873
- Footprinting
	- sudo nmap -sV -p 873 127.0.0.1
## R-Services
- Suite
	- rcp (remote copy)
	- rexec (remote execution)
	- rlogin (remote login)
	- rsh (remote shell)
	- rstat
	- ruptime
	- rwho (remote who)
- Footprinting
	- sudo nmap -sV -p 512,513,514 10.0.17.2
## RDP
- General
	-  Remote Desktop Protocol (RDP)
	- TCP/3389
- Footprinting
	- nmap -sV -sC 10.129.201.248 -p3389 --script rdp*
	- nmap -sV -sC 10.129.201.248 -p3389 --packet-trace --disable-arp-ping -n
	- ./rdp-sec-check.pl 10.129.201.248
- Interaction
	- xfreerdp /u:cry0l1t3 /p:"P455w0rd!" /v:10.129.201.248
## WinRM
- General
	- Windows Remote Management
	- TCP ports 5985 and 5986
- Footprinting
	- nmap -sV -sC 10.129.201.248 -p5985,5986 --disable-arp-ping -n
- Interaction
	- evil-winrm -i 10.129.201.248 -u Cry0l1t3 -p P455w0rD!
## WMI
- General
	- Windows Management Instrumentation (WMI)
	- TCP/135
- Interaction
	- /usr/share/doc/python3-impacket/examples/wmiexec.py Cry0l1t3:"P455w0rD!"@10.129.201.248 "hostname"

