
# Dealing with Incidents

## Incident Response Overview  

##### **Incident Response**
- **Purpose:** Address and manage the aftermath of a security breach or cyberattack.
- **Components:**
  - **Planning:** Prepare for potential incidents by establishing response teams and protocols.
  - **Key Considerations:**
    - **Communication:** Determine if legal or public relations (PR) teams need to be involved.
    - **Action Steps:** Define immediate actions to contain and mitigate the impact of the incident.

##### **Digital Forensics**
- **Purpose:** Investigate and gather evidence from digital devices in a legal and methodical way.
- **Process:**
  - **Evidence Collection:** Secure and analyze data to identify the source of the breach.
  - **Legal Compliance:** Ensure evidence is handled in accordance with legal standards to be admissible in court.

##### **Continuity of Operations**
- **Purpose:** Maintain business functions during and after a disruptive event.
- **Components:**
  - **Alternate Locations:** Establish secondary sites for business operations in case the primary location is compromised.
  - **Business Continuity:** Focus on keeping essential business functions running despite disruptions.

##### **Disaster Recovery**
- **Purpose:** Restore systems and operations to normal after a disaster or major incident.
- **Components:**
  - **Recovery Efforts:** Actions to repair damage and restore data, such as draining water from server rooms or replacing damaged servers.
  - **Restoration:** Bring systems back online using backups and other recovery tools.

## Incident Response Plans (IRPs)  

##### **Incident Response Plan (IRP)**
- **Activation:** Enacted when an incident is confirmed through an Indicator of Compromise (IOC), such as an alert from an Intrusion Detection System (IDS).
- **Triggers:** 
  - Excessive inbound or outbound traffic.
  - Newly detected unauthorized devices.
  - Alerts from IDS/IPS systems.

##### **Components of an IRP**
- **Detection:** Identifying that an incident has occurred.
- **Containment:** Limiting the spread or impact of the incident.
- **Eradication:** Removing the root cause, such as cleansing infected machines.
- **Recovery:** Restoring systems and data to normal operation.
- **Escalation:** Steps for escalating the incident to higher authorities or external consultants if necessary.

##### **Contact and Escalation**
- **Contact List:** Includes key personnel, such as the Chief Security Officer, to be notified in the event of specific incidents (e.g., ransomware attacks).
- **Escalation Protocols:** Predefined steps for escalating unresolved incidents.

##### **Life Cycle of an IRP**
- **Periodic Review:** Regular assessment of threats, assets, and likelihood of incidents, integrating risk management practices.
- **Role Assignment:** Defining roles and responsibilities for responding to incidents.
- **Training and Drills:** Ongoing training and periodic drills to ensure readiness.
- **Lessons Learned:** Post-incident analysis to update the IRP for improved future responses.

##### **Incident Response Process**
- **Identify:** Confirm and classify the incident.
- **Contain:** Isolate the affected areas to prevent further damage.
- **Eradicate:** Remove the cause of the incident.
- **Recover:** Restore operations and data.
- **Review:** Analyze the response and update the IRP based on lessons learned.

##### **Automation in Incident Response**
- **Automated Responses:** Utilizing Intrusion Prevention Systems (IPS) to automate parts of the response, reducing reaction time.

##### **Preparation and Testing**
- **Walkthroughs:** Step-by-step reviews of the IRP.
- **Simulations:** Practical exercises to test response strategies.
- **Tabletop Exercises:** Scenario-based discussions to evaluate readiness.

## IRP Testing  
##### **Tabletop Exercises**
- **Description:** A board game-like scenario where key players walk through potential disaster situations using "what if" narratives and real-world examples.
- **Purpose:** Prepare teams for real incidents without directly engaging in the scenario.
- **Benefits:** 
  - Low-cost, safe environment.
  - Identifies potential vulnerabilities.
  - Refines response strategies.
  - Ensures everyone knows their roles.

##### **Failover Testing**
- **Description:** Similar to lifeboat drills, systems are deliberately switched from primary to backup mode.
- **Purpose:** Measure the efficiency and smoothness of the transition to backup operations.
- **Benefits:** 
  - Validates backup mechanisms.
  - Provides practical rehearsal for IT teams.
  - Ensures swift recovery during actual failures.

##### **Simulations**
- **Description:** Mimics potential cyber attacks or system failures in a controlled environment, similar to video game simulations.
- **Purpose:** Allows teams to practice response strategies and evaluate tool effectiveness without real risk.
- **Benefits:** 
  - Hone response skills.
  - Evaluate effectiveness of tools and procedures.
  - Practice in a controlled environment.

##### **Parallel Processing**
- **Description:** Systems run concurrently, sharing tasks to ensure uninterrupted service, akin to twin engines on an airplane.
- **Purpose:** Distribute tasks to maintain system responsiveness and availability.
- **Benefits:** 
  - Provides redundancy.
  - Mitigates risks associated with single points of failure.
  - Ensures continuous operation even during component failures.

##### **Alert Tuning**
- **Description:** Validates the accuracy of monitoring solutions by identifying false positives, false negatives, true positives, and true negatives.
- **Purpose:** Ensure alerts are accurate and reliable to avoid unnecessary actions or missed issues.
- **Types of Alerts:**
  - **False Positive:** Incorrectly indicates a problem when there is none (e.g., alerting a system breach that hasn’t occurred).
  - **False Negative:** Fails to report a problem when one exists (e.g., a server down but reported as operational).
  - **True Positive:** Correctly identifies a real issue.
  - **True Negative:** Correctly identifies that no issue exists.

##### **Importance of Resilience and Recovery Testing**
- **Purpose:** Ensure organizations are prepared for operational challenges and equipped to respond efficiently.
- **Tools and Methods:** Tabletop exercises, failover testing, simulations, and parallel processing act as drills, backup plans, and performance boosters.
- **Outcome:** Build confidence in the validity of information from network and security monitoring systems, ensuring effective resilience and recovery.
## Threat Analysis and Mitigating Actions  

##### **Cyber Kill Chain**
- **Purpose:** Allows security analysts to trace steps taken in a successful compromise or data event, helping to prevent future occurrences.
- **Phases:**
  - **Reconnaissance:** Attackers gather information about potential targets.
  - **Intrusion:** Scanning and vulnerability scanning, leading to initial entry into the system.
  - **Exploitation:** Attackers exploit vulnerabilities, as seen in tools like the Metasploit framework.
  - **Privilege Escalation:** Attackers gain higher-level access to the compromised system.
  - **Lateral Movement:** Attackers move within the network to compromise additional systems.
  - **Obfuscation/Anti-Forensics:** Covering tracks by clearing logs or using techniques like steganography.
  - **Denial of Service:** Disrupting services as part of the attack.
  - **Exfiltration:** Stealing or exporting sensitive data.

##### **Miter Attack Framework**
- **Purpose:** Used for post-compromise analysis to detect and understand how a threat was realized and how data was stolen.
- **Benefits:**
  - Identifies techniques used by attackers.
  - Helps in configuring defenses such as firewall rules and alerting mechanisms.

##### **Honeypots**
- **Purpose:** Fake decoy traps designed to attract attackers, allowing detailed analysis of their methods.
- **Benefits:**
  - Provides insight into attack techniques.
  - Helps in completing the analysis of past security incidents.

##### **Diamond Model**
- **Purpose:** Analyzes how malicious actors exploited vulnerabilities to infiltrate networks or systems.
- **Components:**
  - **Adversary:** The attacker.
  - **Victim:** The target, whether an individual, server, or network.
  - **Infrastructure:** The medium used for the attack, such as networks with weak authentication.
  - **Capabilities:** The tools and techniques used by the adversary to execute the attack.

##### **Security Orchestration, Automation, and Response (SOAR)**
- **Purpose:** Automates incident response to reduce response time and improve efficiency.
- **Functionality:**
  - **Automation:** Uses scripts and workflows to respond to incidents automatically.
  - **Remediation:** Automates actions like changing firewall rules, modifying deny lists, or revoking PKI certificates during an attack.
  - **Goal:** Minimize the time taken to respond to security incidents and improve overall incident handling.

##### **Incident Response Enhancements**
- **Objective:** Use insights from post-incident analysis to update and improve incident response plans.
- **Methods:**
  - Conduct regular reviews and drills to refine response strategies.
  - Implement automated tools like SOAR to enhance real-time response capabilities.

## Digital Forensics  
##### **Legal Hold**
- **Purpose:** Ensure that no data or digital evidence is deleted or altered during potential litigation.
- **Analogy:** Like police taping off a crime scene to prevent tampering with evidence.

##### **Chain of Custody**
- **Purpose:** Document the timeline of who has handled the digital evidence and when to maintain its integrity and authenticity.
- **Analogy:** Recording who found a footprint, where and when it was found, and securely storing it, similar to physical evidence in a police investigation.

##### **Acquisition**
- **Purpose:** Collect digital data without altering it, using tools and methods to create an exact copy for investigation.
- **Analogy:** Investigators taking pictures of the scene, collecting fingerprints, and ensuring no alteration of evidence in its original place.

##### **Reporting**
- **Purpose:** Analyze digital data and create a report detailing findings, actions taken, and relevant information.
- **Analogy:** A detective writing a detailed report about what happened, what evidence was found, and potential suspects.

##### **E-Discovery**
- **Purpose:** Find, collect, and deliver electronic information that can be used as evidence in a legal case.
- **Analogy:** Sifting through an evidence room to find specific pieces of evidence required for a court case.

##### **Preservation**
- **Purpose:** Ensure that digital evidence remains safe, intact, and unchanged, often by making backup copies or storing them securely.
- **Analogy:** Storing collected evidence in a safe and secure evidence room at a police station.

#### **Steganography in Digital Forensics**

##### **Steganography**
- **Purpose:** Conceal information within seemingly harmless or non-suspicious data, making the hidden data undetectable to third parties.
- **Definition:** Derived from Greek words meaning "covered" or "concealed" writing, it involves hiding data inside a message, image, audio, or video.
- **Context in Forensics:** Criminals may use steganography to hide information within other messages, complicating the retrieval of original evidence by investigators.

##### **Comparison with Cryptography**
- **Cryptography:** Converts plaintext into ciphertext, making messages unreadable to third parties.
- **Steganography:** Hides the existence of a message altogether, making it difficult to detect.

##### **Importance in Digital Forensics**
- **Focus:** Detecting hidden information and understanding the structure of steganographic data is as crucial as maintaining the validity of collected forensic data.
- **Objective:** Discovering, tracking, and safeguarding recovered data is essential for digital forensic professionals.
## Business Continuity and Alternate Sites  

##### **Business Continuity Plan (BCP)**
- **Purpose:** Ensure that business operations can continue during disruptions, such as malware outbreaks, failed servers, or lost network connections.
- **Scope:** Broad and general, covering the overall continuity of operations, also referred to as COOP (Continuity of Operations).

##### **Disaster Recovery Plan (DRP)**
- **Purpose:** Provide specific steps to recover from particular incidents, such as server failures or data corruption.
- **Scope:** Narrower than BCP, with multiple DRPs for different subsystems (e.g., e-commerce servers, file restoration).

##### **Organizational Policies**
- **Integration:** DRPs are implemented in accordance with organizational policies, which may include aspects like change management, asset management, and security.

#### **Types of Disasters**
- **Natural Disasters:** Events like floods, tornadoes, or storms that can disrupt business operations.
- **Man-Made Disasters:** Includes oil spills or intentional sabotage, such as malware attacks.
- **Technological Disasters:** Cybersecurity attacks or system failures that impact IT infrastructure.

##### **Disaster Recovery Sites**

###### **Hot Site**
- **Features:** Pre-configured with hardware, software, networking, and up-to-date data through constant replication.
- **Personnel:** Staff are present, often managed by cloud provider technicians in the case of public cloud sites.
- **Switch Over Time:** Fastest, due to readiness.
- **Cost:** Most expensive due to the extensive planning, effort, and maintenance required.

###### **Warm Site**
- **Features:** Equipped with hardware, software, and networking, but lacks up-to-date data.
- **Personnel:** May or may not have staff on-site.
- **Switch Over Time:** Longer than hot sites, due to the need to upload data before resuming operations.
- **Cost:** Less expensive than hot sites, requiring less upfront planning.

###### **Cold Site**
- **Features:** Basic IT infrastructure with networking in place, but no additional hardware, software, or data.
- **Personnel:** No personnel present.
- **Switch Over Time:** Longest, as nothing is pre-configured or ready to go.
- **Cost:** Least expensive, with minimal setup required.

#### **Site Risk Assessment**
- **Purpose:** Determine the likelihood of disasters affecting the primary site and the need for an alternate site.
- **Considerations:** Factors like location (e.g., floodplains) and the specific risks associated with the site.

##### **Use in Security+ Exam**
- **Focus:** Understanding disaster recovery planning and selecting the appropriate type of site (hot, warm, cold) based on given scenarios.
## Data Backup  
##### **Importance of Data Backups**
- **Purpose:** Ensure the availability of critical business data in the event of a disaster.
- **Common Issues:** Many mission-critical servers lack proper backups, which often becomes evident only when it’s too late.
- **Solution:** Implement comprehensive backup strategies to avoid long restoration times and data loss.

##### **Backup Locations**
- **On-Premises Backups:** 
  - **Devices:** Use of tape devices and storage in fireproof safes.
  - **Network Storage:** Network Attached Storage (NAS) devices or Storage Area Networks (SAN) with backup appliances.
- **Off-Site Backups:**
  - **Physical Locations:** Backup tapes stored off-site in secure locations.
  - **Public Cloud:** Servers automatically back up data to the cloud on a scheduled basis, ensuring off-site protection.

##### **Backup Configuration Considerations**
- **Data Compression:** 
  - **Purpose:** Reduces data size before transmission, particularly important for large datasets sent over the internet.
  - **Considerations:** Necessary when backing up large volumes of data, such as terabytes, to optimize backup time.
- **Data Encryption:** Encrypt backups to protect data at rest, especially when storing sensitive information off-site.

##### **Backup Types**
- **Full or Copy Backup:** 
  - **Description:** All data is backed up, taking the longest time to complete but the shortest time to restore.
  - **Usage:** Typically done weekly or even daily, depending on business needs.
- **Incremental Backup:**
  - **Description:** Only new or modified data since the last incremental backup is copied.
  - **Advantages:** Shortest backup time.
  - **Disadvantages:** Longest restoration time, as all incremental backups since the last full backup are required.
- **Differential Backup:**
  - **Description:** Backs up all data changed since the last full backup.
  - **Advantages:** Quicker to restore than incremental, as only the last full backup and the latest differential are needed.
  - **Disadvantages:** Slower than full backup but faster than incremental for restoration.

##### **Archive Bit and Backup Process**
- **Archive Bit:** 
  - **Function:** Indicates whether a file needs to be backed up. Backup software relies on the archive bit to determine if a file should be included in the backup.
  - **Behavior:** After a backup, the archive bit is turned off until the file is modified again.

##### **Virtual Machine Backups**
- **Snapshot:** 
  - **Purpose:** A point-in-time capture of the virtual machine’s configuration and data.
  - **Limitation:** Useful for quick rollbacks but does not replace full data backups.

##### **Example: Configuring Backups in Windows 10**
- **Accessing Backup Settings:**
  - **Steps:** Go to Settings > Backup settings in Windows 10.
  - **Drive Selection:** Choose a drive (e.g., USB thumb drive) for backup.
- **Scheduling Backups:**
  - **Options:** Configure backups to occur every 15 minutes, every hour, or every 12 hours.
  - **Consideration:** Align backup frequency with the Recovery Point Objective (RPO) to ensure minimal data loss.
- **Backup Scope:** 
  - **Customization:** Choose specific folders or entire drives for backup.

##### **Enterprise-Level Backups**
- **Centralized Backup Devices:** Often used to store backups centrally, with configurations tailored to the needs of the enterprise.
- **Individual Backup Configurations:** Can also be done on individual machines, as demonstrated with Windows 10.




