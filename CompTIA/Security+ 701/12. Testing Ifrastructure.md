
# Testing Ifrastructure

## Testing Infrastructure Overview 

##### **Representation and Protection**
- **Analogy:** Shannon represents IT infrastructure, with her armor symbolizing the security policies and controls in place to protect the infrastructure.
- **Challenge:** Identifying vulnerabilities despite apparent security, much like probing for weak spots in armor.

##### **Vulnerability Awareness**
- **Importance:** Constantly assess vulnerability impacts to ensure effective protection.
- **Approach:** Continuously test for weak spots to uncover vulnerabilities.

##### **Key Areas of Vulnerabilities**
- **Hardware Vulnerabilities:** 
  - **Examples:** Vulnerabilities within CPUs, different types of processors, and hardware components like cameras.
- **Configuration Vulnerabilities:** 
  - **Focus:** Weak configurations, such as using outdated encryption methods like WEP instead of WPA 2 or 3.
- **Management Weaknesses:** 
  - **Examples:** Inadequate user training to recognize threats like spam emails.

##### **Human Factor in Security**
- **Social Engineering:**
  - **Definition:** Exploits people's good nature, familiarity, and urgency to manipulate them into performing actions that compromise security.
  - **Example:** An attacker impersonating a trusted colleague to gain access to sensitive items or information.

##### **Threats Beyond Human Error**
- **Artificial Intelligence Threats:**
  - **AI in Attacks:** Malware that leverages AI to adapt its behavior, such as changing language based on usernames.
  - **Adversarial AI:** The use of AI by attackers to compromise systems, a growing concern in cybersecurity.

##### **Security Assessments**
- **Internal Security Assessments (Vulnerability Assessment):**
  - **Tools:** Common tools include ping and netcat to test systems internally.
  - **Limitations:** Internal assessments may have biases due to easier access to credentials and system information.
- **External Security Assessments (Penetration Testing):**
  - **Method:** Hiring third-party pen testers to simulate external attacks and uncover weaknesses from an outsider's perspective.
  - **Outcome:** Provides an objective evaluation of the infrastructure's security posture.
## Social Engineering Attacks  

##### **Overview of Social Engineering**
- **Definition:** Social engineering attacks are digital cons or scams where attackers exploit human emotions and behaviors to deceive victims into performing actions or divulging sensitive information.
- **Goal:** The primary goal of social engineering is to manipulate unsuspecting individuals into compromising their security, often without the need for technical hacking.

##### **Techniques Used in Social Engineering**
- **Impersonation:** 
  - **Description:** Attackers pretend to be someone trustworthy, such as a bank manager or government official, to gain the victim's trust.
  - **Example:** An attacker calls a victim, pretending to be a bank manager, to resolve a supposed issue with the victim's account.
- **Urgency:** 
  - **Description:** The attacker creates a sense of urgency, forcing the victim to make quick decisions without careful consideration.
  - **Example:** An urgent email claims the victim’s account will be locked unless immediate action is taken.
- **Misinformation/Disinformation:** 
  - **Description:** The attacker fabricates scenarios to trick victims into revealing information.
  - **Example:** A letter claiming the victim has won a sweepstakes and must provide personal details to claim the prize.

##### **Common Social Engineering Attack Vectors**

- **Phishing:**
  - **Vector:** Email.
  - **Attack Surface:** Unsuspecting email users.
  - **Description:** Victims receive legitimate-looking emails with malicious links or attachments, tricking them into revealing personal information or installing malware.
- **Vishing (Voice Phishing):**
  - **Vector:** Phone call.
  - **Attack Surface:** Targeted individuals over the phone.
  - **Description:** Attackers pose as credible entities, like banks or government agencies, to extract personal or financial information from victims.
- **Smishing (SMS Phishing):**
  - **Vector:** SMS text or direct messaging.
  - **Attack Surface:** Mobile phones or social media apps.
  - **Description:** Attackers send text messages with malicious links or requests for personal information, often appearing as legitimate messages from trusted sources.
- **Business Email Compromise (BEC):**
  - **Vector:** Compromised business email account.
  - **Attack Surface:** Partners or clients of the compromised account.
  - **Description:** Attackers use a hacked business email account to request fraudulent payments or sensitive data from trusted contacts.
- **Pretexting:**
  - **Vector:** Fabricated scenario.
  - **Attack Surface:** Individuals or businesses.
  - **Description:** The attacker creates an elaborate story to manipulate victims into revealing information or performing actions that compromise security.
  - **Example:** A fake IRS agent calls to warn of an arrest warrant, tricking the victim into calling back and following instructions.
- **Watering Hole Attack:**
  - **Vector:** Compromised legitimate website.
  - **Attack Surface:** Visitors to the compromised site.
  - **Description:** Attackers compromise a trusted website, exploiting visitors who assume the site is safe.
- **Brand Impersonation:**
  - **Vector:** Email or social media.
  - **Attack Surface:** Victims targeted through email or social media.
  - **Description:** Attackers pretend to represent well-known brands or celebrities to steal personal or financial information.
- **Typosquatting:**
  - **Vector:** Misspelled domain names.
  - **Attack Surface:** Internet users who mistype website addresses.
  - **Description:** Attackers register domains with slight misspellings of popular websites, leading users to malicious sites when they mistype URLs.

##### **Protection Against Social Engineering**
- **Key Advice:** Always be cautious, verify identities, and never share personal or sensitive information without confirming the legitimacy of the communication.
- **Human Psychology:** Social engineering manipulates human psychology rather than exploiting technical vulnerabilities, making awareness and vigilance critical in defense.
## Vulnerability Assessments  

##### **Reconnaissance and Scanning**
- **Reconnaissance:** The initial phase in an attack where information gathering is conducted to identify potential targets and vulnerabilities.
- **Post-Reconnaissance:** After reconnaissance, attackers proceed to scanning for vulnerabilities to determine if the identified targets are exploitable.

##### **Vulnerability Scanning**
- **Purpose:** Vulnerability scanning is the process of probing and analyzing systems to identify security weaknesses without exploiting them.
- **Baseline Scans:** Initially, a baseline scan is performed to document the network’s current state, including all software versions and configurations. Future scans are then compared against this baseline to detect changes or potential compromises.

##### **Types of Vulnerability Scans**
- **Credentialed Scans:** 
  - **Description:** Scans that use valid credentials to authenticate to devices on the network, allowing for a thorough inspection of security settings and vulnerabilities.
  - **Target Devices:** Servers, smartphones, laptops, network switches, routers, etc.
- **Uncredentialed Scans:** 
  - **Description:** Scans performed without valid credentials, simulating an attacker's perspective who lacks internal access.
  - **Purpose:** To identify vulnerabilities that are visible to unauthorized users.

##### **Tools for Vulnerability Scanning**
- **Examples of Tools:**
  - **Landguard:** A tool used for vulnerability scanning, providing a detailed analysis of network vulnerabilities.
  - **OpenVAS:** Another popular tool for performing vulnerability assessments.
  - **Nessus:** A well-known vulnerability scanner that helps identify potential weaknesses in the network.

##### **Vulnerability Databases**
- **Importance of Updates:** Vulnerability scanners rely on a database of known vulnerabilities. Regular updates to this database are crucial to ensure that newly discovered vulnerabilities are identified during scans.
- **False Negatives:** If the vulnerability database is outdated, the scanner might miss vulnerabilities, leading to a false sense of security.

##### **Interpreting Scan Results**
- **Visualization:** Tools like Landguard provide dashboards with visual representations of vulnerabilities, using color-coded indicators to prioritize risks (e.g., high vulnerabilities shown in red).
- **Detailed Analysis:** 
  - **Example:** Scanning a network might reveal high security vulnerabilities like AutoRun being enabled, which can be exploited to spread malware.
  - **Device Types:** Scans can reveal vulnerabilities not only in computers but also in IoT devices, network printers, and infrastructure equipment.

##### **Vulnerability Scanning Best Practices**
- **Regular Scanning:** Schedule periodic scans to continuously monitor and secure the network against new vulnerabilities.
- **Combination of Scans:** Utilize both credentialed and uncredentialed scans to get a comprehensive view of the network's security posture.
- **Focus Areas:** Depending on the network size, focus scans on specific hosts, application servers, or individual applications to efficiently identify vulnerabilities.

##### **Scenario-Based Usage**
- **Security Plus Exam Context:** For scenarios where vulnerabilities need to be identified without active exploitation, a vulnerability assessment (passive scanning) is the appropriate method, distinguishing it from penetration testing which actively attempts to exploit vulnerabilities.
## Penetration Testing  

##### **Attacker Progression**
- **Reconnaissance:** The initial phase where attackers gather information about potential targets, identifying vulnerabilities that could be exploited.
- **Vulnerability Scanning:** After identifying targets, attackers scan for vulnerabilities to determine if any systems or networks can be compromised. This process is passive, focusing on identifying weaknesses without exploiting them.

##### **Penetration Testing Overview**
- **Definition:** Penetration testing (pen testing) involves actively exploiting known vulnerabilities to assess the security of a system or network.
- **Risks:** Active exploitation can potentially cause system crashes or expose sensitive information. Therefore, pen testing must be conducted with caution and only with explicit written consent from the system owners.

##### **Legal and Ethical Considerations**
- **Non-Disclosure Agreement (NDA):** Before conducting a penetration test, testers are typically required to sign an NDA. This legal document ensures that any sensitive information discovered during the test remains confidential.
- **Security+ Exam Tip:** For the Security+ exam, remember that an NDA is the legal document associated with penetration testing, not a business impact plan or memorandum of understanding.

##### **Penetration Testing Types**
- **Known Perspective (Insider):** The tester has insider knowledge of the network or host, simulating an attack from someone with authorized access, such as an insider threat.
- **Unknown Perspective (External):** The tester knows nothing about the environment, requiring extensive reconnaissance and scanning to identify vulnerabilities.
- **Partially Known Perspective:** The tester has limited information, such as knowing the types of devices in use but not their configurations.

##### **Bug Bounty Programs**
- **Definition:** Vendors offer financial incentives (bug bounties) to security researchers who discover and responsibly disclose zero-day vulnerabilities.
- **Example - Google Vulnerability Reward Program:** Google offers rewards for finding vulnerabilities in its services, with payouts varying based on the severity of the issue. Vulnerabilities like remote code execution on Google accounts can fetch significant rewards.

##### **Penetration Testing Process**
- **Rules of Engagement:** Establish and agree on the rules for the pen test, including what is allowed and what is off-limits. For example, cloud providers like AWS have specific rules for pen testing their services.
- **Testing Phases:**
  - **Discovery and Enumeration:** Tools like nmap are used to map the network and identify hosts and services.
  - **Vulnerability Identification:** Run vulnerability scans to detect potential weaknesses.
  - **Exploitation:** Actively exploit identified vulnerabilities to gain access to the system.
  - **Privilege Escalation:** After gaining initial access, attempt to escalate privileges (e.g., gaining root access on a Linux system).
  - **Persistence:** Install backdoors or other mechanisms to maintain long-term access without detection.
  - **Pivoting and Lateral Movement:** Use the compromised host to explore and access additional systems within the network.
  - **Cleanup:** Remove evidence of the test, such as log entries, to prevent detection.
  - **Reporting:** Generate a report detailing the findings, including vulnerabilities exploited, methods used, and recommendations for remediation.

##### **Red, Blue, White, and Purple Teams in Penetration Testing**
- **Red Team:** The attackers who simulate real-world attacks on the network or system.
- **Blue Team:** The defenders who monitor, detect, and respond to the attacks initiated by the Red Team.
- **White Team:** Manages and oversees the engagement between the Red and Blue Teams, ensuring rules are followed.
- **Purple Team:** Facilitates communication and knowledge transfer between the Red and Blue Teams to improve overall security.

## The Metasploit Framework  

##### **Overview**
- **Purpose:** The Metasploit Framework is a widely used penetration testing tool designed for exploiting discovered vulnerabilities. While it can also perform reconnaissance, vulnerability scanning, and network mapping, its primary use is in the exploitation phase of a penetration test.
- **Cross-Platform:** Metasploit runs on multiple platforms, including Linux (with Kali Linux having it pre-installed) and Windows.

##### **Associated Tools**
- **Metasploitable:** An intentionally vulnerable virtual machine often used alongside Metasploit for testing and demonstrations. It is available for free on the Rapid7 website and provides a safe environment for practicing penetration testing techniques.

##### **Keeping Metasploit Updated**
- **Exploit Database:** Similar to vulnerability scanners, Metasploit relies on an up-to-date database of exploits. Regular updates ensure that the latest vulnerabilities can be exploited during penetration tests.

##### **Terminology**
- **Payloads:** In Metasploit, a payload is the actual code that is executed on the target system after a successful exploit. Payloads can vary depending on the target and the type of attack being performed.
- **Exploits:** These are the methods used to take advantage of vulnerabilities in a system. Exploits allow penetration testers to interact with compromised devices, often by gaining remote access through a shell.

##### **Using Metasploit for Penetration Testing**

- **Starting Metasploit:**
  - **MSF Console:** The primary interface for using Metasploit is the MSF console. It is where you start the tool and begin searching for and selecting exploits.
  
- **Example Exploit - Denial of Service (DoS) with Slowloris:**
  - **Scenario:** Using Metasploit to perform a denial of service attack against a vulnerable web application.
  - **Steps:**
    1. **Verify Target Availability:** Check the target website in a web browser to ensure it is responding normally.
    2. **Search for Exploit:** In the MSF console, use the `search` command to find the Slowloris DoS exploit.
    3. **Select the Exploit:** Use the `use` command to activate the Slowloris exploit.
    4. **Set Target Details:** Use the `set` command to specify the target’s IP address (referred to as `RHOST` in Metasploit).
    5. **Execute the Attack:** Run the `exploit` command to initiate the denial of service attack.

- **Attack Results:**
  - **Impact:** The website under attack becomes unresponsive as legitimate traffic is blocked by the flood of malicious requests. This demonstrates the simplicity and effectiveness of denial of service attacks using tools like Metasploit.

##### **Mitigation Techniques**
- **Black Hole Routing:** A method to mitigate DoS attacks by routing suspicious traffic to a null destination. This approach helps to prevent the malicious traffic from overwhelming the target but can have limitations in distinguishing between legitimate and malicious traffic.



