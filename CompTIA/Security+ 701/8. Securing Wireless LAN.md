# Securing Wireless LANs
## Wi-Fi Encryption Standards  
##### **WEP (Wired Equivalent Privacy)**
- **Introduction:** WEP was part of the original 802.11 standard, introduced around 2000-2001.
- **Encryption:** Utilized RC4 for streaming encryption.
- **Weaknesses:** 
  - Relied on weak initialization vectors (IVs) based on SSID passcodes.
  - Easily cracked due to poor IV implementation.
- **Status:** Considered highly insecure and deprecated by 2003-2004.

##### **WPA (Wi-Fi Protected Access)**
- **Introduction:** Developed as an interim solution to address WEP's vulnerabilities.
- **Encryption:** 
  - Continued using RC4 encryption but implemented improved security measures.
  - Introduced Pre-Shared Key (PSK) and enterprise modes for better security.
- **Compatibility:** Designed to work with older hardware that couldn't handle AES encryption.

##### **WPA2**
- **Introduction:** Became the most widely used wireless encryption standard by 2007-2008.
- **Encryption:**
  - Switched from RC4 to AES encryption, providing much stronger security.
  - Introduced Counter Mode Cipher Block Chaining Message Authentication Code Protocol (CCMP) to enhance security.
- **Strengths:** 
  - Provided robust encryption and was the de facto standard for over a decade.
- **Weaknesses:** 
  - Vulnerable to certain attacks, such as those exploiting the handshake process.

##### **WPA3**
- **Introduction:** The latest standard, providing enhanced security features.
- **Encryption:** 
  - Utilizes more robust AES encryption with additional security measures.
  - Introduced Simultaneous Authentication of Equals (SAE) to replace PSK.
- **Features:**
  - **Protected Management Frames (PMF):** Secures management frames to prevent exploitation.
  - **No PSK Mode:** SAE automatically encrypts connections without the need for passcodes.
- **Strengths:** 
  - Significantly more secure than previous standards.
  - Designed to phase out outdated protocols like WEP and WPA.
- **Challenges:** Older wireless cracking tools designed for WPA2 are ineffective against WPA3.

##### **WPS (Wi-Fi Protected Setup)**
- **Purpose:** Simplified the process of connecting devices to a WPA2 network.
- **Functionality:** 
  - Involved pressing a button on the wireless access point (AP) and the device to establish a connection.
  - Created an encrypted connection between the device and the AP.
- **Weaknesses:** 
  - The encryption method used by WPS was easily cracked, making it insecure.
  - Many modern routers have discontinued support for WPS.
- **Status:** WPS is being phased out, especially as WPA3 becomes more prevalent.

##### **Key Takeaways**
- **Wireless Encryption Levels:** Understand the four main levels of wireless encryption: WEP, WPA, WPA2, and WPA3.
- **Avoid WPS:** While still present in some devices, WPS is insecure and should be avoided whenever possible.

## RFID, NFC, and Bluetooth  

##### **RFID (Radio Frequency Identification)**
- **Usage:**
  - Commonly used in retail for inventory control and anti-theft systems.
  - Utilized in pet locators and some passport implementations.
- **Range:** Approximately 5 meters (16 feet).
- **Power Source:** Activated by proximity to a scanning device that emits power.

##### **NFC (Near-Field Communication)**
- **Relationship to RFID:** A subset of RFID technology with a much shorter range.
- **Range:** About 5 centimeters (1.5 inches).
- **Usage:**
  - Contactless payments (e.g., credit cards and smartphones).
  - Data sharing via NFC tags (e.g., sharing Wi-Fi credentials).
- **Application:** Can be used for various personal and business applications, such as automating tasks with NFC-enabled smartphones.

##### **Bluetooth (802.15.1 Standard)**
- **Frequency Range:** Operates in both the 2.4GHz and 5GHz frequency ranges.
- **Range:**
  - **Class 1:** Up to 100 meters (328 feet).
  - **Class 2:** Approximately 10 meters (30 feet).
- **Usage:**
  - Common in devices such as USB dongles, headphones, car stereos, speakers, and keyboards.
  - Allows for pairing between devices for trusted data transfer.
  - Enables local file sharing between smartphones without the need for internet access.

##### **Bluetooth Security**
- **Attacks:**
  - **Bluejacking:** Sending unsolicited messages or contact information to nearby Bluetooth devices.
  - **Bluesnarfing:** Capturing Bluetooth network traffic for analysis, potentially using tools like Wireshark.
- **Hardening Tip:** Disable Bluetooth when not in use to prevent potential attacks.

##### **Wireless Security Considerations**
- **NFC:** While possible to attack, its very short range makes it difficult to do so without detection.
- **General Advice:** Always disable unnecessary wireless communication protocols as part of standard device hardening procedures.

## Wi-Fi Coverage and Performance  
##### **Wi-Fi Coverage**
- **Importance:** Ensuring optimal performance and security by managing Wi-Fi coverage.
- **Signal Strength:**
  - **Measurement:** Decibel milliwatts (DBMs).
  - **Good Connection:** -30 DBM (high performance).
  - **Poor Connection:** -80 DBM (weaker connection).

##### **Environmental Factors**
- **Impact on Wi-Fi Signals:** 
  - **Atmospheric Conditions:** Snow, rain, and sandstorms can affect wireless transmissions.
  - **Example:** Similar to how satellite television signals are affected during storms.

##### **High-Gain Antennas**
- **Cantenna:** 
  - **Purpose:** A high-gain antenna to extend Wi-Fi range.
  - **DIY Option:** Can be made using a Pringles can or orange juice can.
  - **Effect:** Extends the range of Wi-Fi signals beyond standard coverage, possibly up to a mile.

##### **Wi-Fi Site Survey**
- **Purpose:** To map out wireless access points and their coverage areas, and to troubleshoot issues like overlapping channels.
- **Key Metrics:**
  - **Signal Strength:** -30 DBM is good, -80 DBM is poor.
  - **Noise:** Interference that reduces Wi-Fi transmission integrity.
  - **Channel Overlapping:** 
    - **Issue:** Causes interference and unreliable connections.
    - **Solution:** Assign unique channels to nearby wireless networks to avoid overlap.

##### **Tools for Wi-Fi Site Survey**
- **Example Tool:** Netspot.
  - **Functionality:** 
    - **Discover Wireless Networks:** Identifies all visible wireless access points and their details.
    - **Signal Strength Analysis:** Provides signal strength metrics for each network.
    - **Heat Map Creation:** 
      - **Purpose:** Visually represents Wi-Fi coverage.
      - **Color Coding:** 
        - **Red/Yellow:** Strong signal.
        - **Blue:** Weak signal.
      - **Usage:** Helps identify areas with poor Wi-Fi coverage for potential improvement.

##### **Security Implications**
- **Site Surveys by Malicious Users:** 
  - **Threat:** Attackers can use similar tools to identify and exploit poorly secured wireless networks.
  - **Mitigation:** Ensuring strong security standards like WPA3 are in place to protect the network.
## Wi-Fi Discovery and Attacks  
##### **Techniques for Discovering Wireless Networks**
- **Warchalking:**
  - **Description:** Physically marking the location of open wireless networks on sidewalks.
  - **Purpose:** Identifying and marking open Wi-Fi networks in public spaces.

- **Wardriving:**
  - **Description:** Scanning for wireless networks while driving around an area.
  - **Tools:** Laptop, Wi-Fi scanning apps, and potentially a cantenna for extended range.
  - **Purpose:** Collecting information on available wireless networks in a specific area.

- **War Flying:**
  - **Description:** Using drones equipped with Wi-Fi scanning capabilities.
  - **Purpose:** Scanning for wireless networks from the air, often over private properties.

##### **Rogue Access Points and Attacks**
- **Rogue Access Point:**
  - **Description:** Unauthorized access point connected to a secure network.
  - **Risk:** Could be intentionally or unintentionally set up, providing an entry point for attackers.

- **Evil Twin:**
  - **Description:** A malicious access point mimicking a legitimate one, often with the same SSID.
  - **Scenario:** 
    - **Example:** Setting up a fake "Starbucks free Wi-Fi" in a coffee shop to capture traffic.
    - **Risk:** Users unknowingly connect to the malicious AP, exposing their network traffic to attackers.

##### **Wi-Fi Beacon Frames**
- **Beacon Frames:**
  - **Purpose:** Broadcast by access points approximately every 100 milliseconds to announce the presence of a Wi-Fi network.
  - **Contents:** SSID (network name), signal strength, and other configuration details.
  - **Security Issue:** Beacon frames can be spoofed since they are broadcast before any authentication occurs.

##### **Wi-Fi Attacks**
- **Open Network Connection:**
  - **Description:** Connecting to a Wi-Fi network without encryption or authentication.
  - **Risk:** Open networks are vulnerable to eavesdropping and unauthorized access.

- **WEP Cracking:**
  - **Description:** Exploiting vulnerabilities in WEP encryption.
  - **Risk:** WEP can be cracked in seconds with readily available tools, making it insecure.

- **Radio Frequency Signal Jamming:**
  - **Description:** Disrupting Wi-Fi communication by overwhelming the network with interference.
  - **Purpose:** Causes denial of service by preventing legitimate communication.

- **Deauthentication Attack:**
  - **Description:** Forcing a client off a Wi-Fi network by sending deauthentication frames.
  - **Purpose:** 
    - **Attack Goal:** Capturing the initial handshake to break into the network.
    - **Denial of Service:** Repeatedly kicking users off the network.

##### **Wireless Interface Configuration and Scanning**
- **Promiscuous Mode:**
  - **Description:** A network card mode that allows it to capture all traffic, not just the traffic intended for it.
  - **Requirement:** Necessary for advanced Wi-Fi scanning and attack tools.

- **Packet Injection:**
  - **Description:** A capability required to send packets on the network, often used in attacks like deauthentication.

- **Using Airodump-ng:**
  - **Command:** `sudo airodump-ng wlan0`
  - **Purpose:** Scanning and displaying nearby wireless networks, including details like BSSID (MAC address), channel, encryption type, and signal strength.

- **Key Metrics in Scanning:**
  - **BSSID:** The MAC address of the access point.
  - **Channel:** The channel on which the access point operates.
  - **Encryption Type:** Whether the network uses WEP, WPA, WPA2, etc.
  - **Signal Strength:** Measured in DBM, indicating the proximity of the access point.


## Cracking WPA2  

##### **Legal and Ethical Considerations**
- **Disclaimer:**
  - **Importance:** It is illegal to break into a wireless network that you do not own or do not have explicit written consent to test.
  - **Legal Implications:** Breaking into an encrypted wireless network violates privacy and is against the law.

##### **Steps to Crack WPA2 Passphrase**

- **Step 1: Discover Access Points**
  - **Objective:** Identify the target wireless network's MAC address (BSSID) and the channel it operates on.
  - **Command Example:** `sudo airodump-ng wlan0`
  - **Details:**
    - **BSSID:** The MAC address of the target access point.
    - **Channel:** The channel number on which the target access point is broadcasting.

- **Step 2: Identify Connected Clients**
  - **Objective:** Ensure there is at least one client connected to the network or wait for a client to connect.
  - **Importance:** Capturing the handshake during a client's authentication is crucial for cracking the passphrase.

- **Step 3: Deauthenticate a Client**
  - **Objective:** Force a connected client to reauthenticate, allowing you to capture the handshake.
  - **Command Example:** `sudo aireplay-ng --deauth 1 -a [BSSID] -c [Client MAC] wlan0`
  - **Details:**
    - **BSSID:** The MAC address of the access point.
    - **Client MAC:** The MAC address of the connected client.

- **Step 4: Capture WPA2 Handshake**
  - **Objective:** Capture the handshake during the client's reauthentication process.
  - **Command Example:** `sudo airodump-ng --bssid [BSSID] --channel [Channel] --write WPA wlan0`
  - **Details:**
    - **Capture File:** The handshake is saved in a file for offline analysis and cracking.

- **Step 5: Crack the WPA2 Passphrase**
  - **Objective:** Use a wordlist to brute force the WPA2 passphrase.
  - **Command Example:** `aircrack-ng WPA-06.cap -w common_passwords.txt`
  - **Details:**
    - **Wordlist:** A text file containing potential passphrases.
    - **Result:** The correct passphrase is identified from the handshake data.

##### **Tools and Commands**
- **Airodump-ng:**
  - **Purpose:** Discover wireless networks and gather information like BSSID, channel, and connected clients.
  - **Command:** `sudo airodump-ng wlan0`
  
- **Aireplay-ng:**
  - **Purpose:** Deauthenticate a connected client to capture the handshake.
  - **Command:** `sudo aireplay-ng --deauth 1 -a [BSSID] -c [Client MAC] wlan0`

- **Aircrack-ng:**
  - **Purpose:** Crack the WPA2 passphrase using a captured handshake and a wordlist.
  - **Command:** `aircrack-ng WPA-06.cap -w common_passwords.txt`

##### **Key Takeaways**
- **WPA2 Handshake:**
  - **Importance:** The handshake contains the information needed to attempt a brute-force attack on the WPA2 passphrase.
  
- **Wordlist Attack:**
  - **Description:** A wordlist (dictionary attack) is used to compare possible passphrases against the captured handshake.
  - **Success Rate:** The attack’s success depends on whether the passphrase is in the wordlist.

## Wi-Fi Hardening  

##### **Authentication Enhancements**
- **Radius Authentication:**
  - **Standard:** IEEE 802.1X
  - **Description:** Instead of using a Pre-shared Key (PSK) on the wireless access point, authentication requests are forwarded to a centralized Radius server.
  - **User Authentication:** Users authenticate using credentials like username, password, smart card, and/or PKI certificates, making it more secure than a shared passphrase.
  
- **EAP (Extensible Authentication Protocol) Variants:**
  - **EAP-FAST:** Uses a shared secret instead of PKI certificates for authentication.
  - **EAP-TLS (Transport Layer Security):** Requires both the server and client to have PKI certificates for mutual authentication.
  - **EAP-TTLS:** Requires only a server certificate and encapsulates Radius messages.
  - **Protected EAP:** Also requires a server certificate and encapsulates EAP messages for secure transmission.

##### **Basic Security Measures**
- **Change Default Credentials:**
  - **Importance:** Default admin credentials should be changed to prevent unauthorized access.
  
- **Hide SSID (Service Set Identifier):**
  - **Description:** Disable SSID broadcast so that the network name is not visible to nearby devices, making it harder for unauthorized users to find the network.
  
- **MAC Address Filtering:**
  - **Function:** Allows or denies network access based on device MAC addresses.
  - **Note:** Although MAC addresses can be spoofed, this adds an extra layer of security.

##### **Advanced Security Protocols**
- **Use WPA3:**
  - **Recommendation:** Upgrade to WPA3 for stronger security if supported by devices. If not, consider replacing devices that do not support WPA3.
  - **Combination:** Use WPA3 along with Radius server authentication for enhanced security.

##### **Controlling Wi-Fi Signal Range**
- **Adjust Signal Strength:**
  - **Purpose:** Limit the wireless signal range to avoid unnecessary exposure beyond the intended coverage area, such as preventing the signal from reaching public areas like streets or neighboring buildings.

##### **Captive Portals**
- **Description:**
  - **Function:** A landing page that appears when connecting to a public Wi-Fi network, often requiring the user to accept terms of service or authenticate.
  - **Implementation:** Acts as a forward proxy at the application layer (OSI Layer 7), controlling access to the internet after the initial connection.

##### **Practical Example: Securing a D-Link Wireless Router**
- **Wireless Settings:**
  - **SSID Naming:** Avoid naming the SSID with identifiable information (e.g., "Boardroom Floor 12"). Use generic names like "D-Link."
  
- **Range Settings:**
  - **Extended Range Mode:** Disable if the existing range is sufficient to avoid unnecessary signal extension.
  
- **Hidden Wireless:**
  - **Enable:** Suppresses the SSID from beacon frames, making the network appear as "hidden" to nearby devices.
  
- **Security Mode:**
  - **Avoid WEP:** Do not use WEP due to its vulnerability.
  - **Prefer WPA2/WPA3:** Enable WPA2 or WPA3, selecting AES as the encryption cipher.
  
- **Enterprise Mode:**
  - **Radius Server Configuration:** For enterprise environments, configure Radius server details, including IP address, ports (default 1812), and shared secret for secure authentication requests.



