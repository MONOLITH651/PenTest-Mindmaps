# Identity and Account Management
## Identification, Authentication, and Authorization  
##### **Identification, Authentication, and Authorization**
- **Identification**
  - **Purpose**: Identify who the user is, typically through a username or similar identifier.
- **Authentication**
  - **Purpose**: Verify that the identified user is who they claim to be, usually via a password or other means.
- **Authorization**
  - **Purpose**: Determine what the authenticated user is allowed to do within the system, such as read or write permissions on files.

#### **Understanding the Concepts Through an Analogy**

##### **Theater Ticket Example**
- **Identification**
  - **Scenario**: The theater staff asks for your last name to identify your ticket reservation.
  - **Example**: Providing a driver's license as a form of identification.
- **Authentication**
  - **Scenario**: You must present a confirmation number or printed ticket to authenticate yourself.
  - **Example**: Showing a confirmation number that only you know to prove your identity.
- **Authorization**
  - **Scenario**: Your ticket allows you to sit in a specific seat at the theater.
  - **Example**: The ticket indicates you are authorized to sit in a particular seat.

#### **Multi-Factor Authentication (MFA)**

##### **Overview**
- **Definition**: The use of more than one factor or attribute to authenticate a user.
- **Common Factors**:
  - **Something You Know**: Example - Password or PIN.
  - **Something You Have**: Example - Smart card, RSA token.
  - **Something You Are**: Example - Fingerprint, facial recognition.

##### **Attributes in Multi-Factor Authentication**
- **Something You Can Do**
  - **Example**: Unique signature or typing speed.
- **Something You Exhibit**
  - **Example**: Typing speed or other unique behavioral traits.
- **Someone You Know**
  - **Example**: Trust relationships, such as a certificate from a trusted authority.
- **Somewhere You Are**
  - **Example**: Geolocation, such as requiring a zip code when using a credit card at a gas station.

#### **Practical Application of MFA**

##### **Importance of MFA in Security**
- **Why It Matters**: Protects against unauthorized access even if one factor (like a password) is compromised.
- **Common Use Cases**: 
  - **Two-Factor Authentication**: Typically involves a password plus another factor like an RSA token or biometric data.

##### **CompTIA Security+ Exam Focus**
- **Key Points to Remember**:
  - **Three Main Factors**: Something you know, something you have, and something you are.
  - **Attributes**: Understand the difference between attributes like someone you know (trusts) and something you can do (signature).

## Enabling Multifactor Authentication
#### **Multi-Factor Authentication (MFA) in Azure**

##### **Identification, Authorization, Authentication, and Accounting**
- **Identification**
  - **Purpose**: Authenticate users with an additional factor.
- **Authorization**
  - **Purpose**: Assign permissions after successful authentication.
  - **Context**: Users signed in with MFA realize these permissions.
- **Accounting (Auditing)**
  - **Purpose**: Audit and account for the user's activity after signing in.

#### **Enabling MFA for a Microsoft Azure User Account**

##### **Accessing User Accounts**
- **Navigating to Azure Active Directory**
  - **Steps**:
    - Open the left-hand navigator in the Azure portal.
    - Scroll down to and select "Azure Active Directory."
    - Click on "Users" to view a list of user accounts in Azure AD.

##### **Configuring MFA for a User**
- **Selecting the User**
  - **Example**: User named "user1."
- **Enabling MFA**
  - **Steps**:
    - Click the "Multi-Factor Authentication" button to open a new browser window.
    - Check the state of MFA for each user (enabled or disabled).
    - Enable MFA for "user1" by clicking the check mark and selecting "Enable Multi-Factor Auth."
    - Verify that MFA is enabled (note the distinction between enabled and enforced).

##### **User Experience During First Sign-In After MFA is Enabled**
- **Initial Sign-In Steps**
  - **Process**:
    - Sign in with the userâ€™s email address and known password.
    - Trigger the MFA setup by requiring additional information for security.

##### **Configuring Additional Authentication Methods**
- **Choosing Authentication Method**
  - **Options**:
    - Microsoft Authenticator App.
    - SMS text message to a phone.
- **Setting Up SMS Verification**
  - **Steps**:
    - Specify country and phone number.
    - Select SMS text message as the authentication method.
    - Enter the received six-digit code to verify.

##### **Completing MFA Setup**
- **Finalizing Sign-In**
  - **Process**:
    - After successful SMS verification, the user completes the sign-in.
    - Future logins require the six-digit code in addition to the username and password.

#### **Summary of Enabling MFA in Microsoft Azure**
- **Outcome**: MFA is successfully enabled for the user, adding an extra layer of security to their Azure AD account.
## Authorization  
#### **Authentication and Authorization in the Cloud**

##### **Authentication and Authorization Process**
- **Authentication**
  - **Purpose**: Proving the identity of a user, device, or software component.
  - **Outcome**: Successful authentication grants access to resources based on permissions.
- **Authorization**
  - **Purpose**: Assigning permissions to the authenticated entity (user, device, or software).
  - **Resources**: Targets that permissions are applied to, such as files, databases, or web applications.
  - **Auditing**: Tracking access to resources for accountability, including who accessed what, when, and for how long.

#### **Assigning Permissions in Microsoft Azure**

##### **Enabling Managed Identity for a Virtual Machine**
- **Steps to Enable Managed Identity**:
  - Open the Azure portal and navigate to the "Virtual Machines" section.
  - Select the desired virtual machine (e.g., VM2).
  - In the virtual machine's properties, scroll down to "Identity" in the left-hand navigator.
  - Under "System Assigned," set the status to "On" and click "Save."

##### **Assigning Permissions to the Virtual Machine**
- **Steps to Assign Permissions**:
  - Navigate to "Storage Accounts" in the left-hand navigator.
  - Select the storage account where permissions need to be set.
  - Click "Access Control (IAM)" in the navigation bar.
  - Click "Add" and select "Add Role Assignment."
  - Filter roles by typing "storage" and select "Storage Account Contributor."
  - Choose "Assign access to" and select "Virtual Machine."
  - Select the virtual machine (e.g., VM2) from the list.
  - Click "Save" to assign the role.

##### **Verifying Role Assignment**
- **Steps to Verify**:
  - After assigning the role, click on "Role Assignments" to review the permissions.
  - Scroll to the "Storage Account Contributor" role to ensure VM2 is listed.
  - This confirms that the virtual machine has the necessary permissions to manage the storage account.

#### **Key Points**
- **Managed Identity**: A system-assigned identity for the virtual machine that allows it to be granted permissions.
- **Role Assignment**: The process of granting specific permissions to a virtual machine based on its managed identity.
- **Authorization After Authentication**: Access to resources like storage accounts is granted only after the virtual machine has been successfully authenticated.
## Accounting  
#### **Accounting and Auditing in IT Security**

##### **Importance of Accounting**
- **Purpose**: Tracking user activity to ensure accountability.
- **Shared Accounts**: Avoid sharing user accounts to maintain accurate tracking of individual actions.
- **Permissions Auditing**: Track permissions related to file access, creation, reading, writing, and other activities.

##### **Audit Targets**
- **Resource Access**
  - **Files and Databases**: Track access to specific files and database entries.
  - **VPN Access**: Audit unusual login times, such as late-night VPN connections.
- **Failed Logon Attempts**
  - **Indicators of Compromise**: Track failed logon attempts as potential signs of brute force attacks.
- **Data Integrity**
  - **Change Verification**: Use audit logs alongside hash values to verify if data has been tampered with.
  - **Accountability**: Track who made changes to sensitive data.

#### **Practical Auditing in a Windows Environment**

##### **Accessing the Event Viewer**
- **Remote Desktop Connection**: Connect to a Windows virtual machine using Remote Desktop.
- **Event Viewer**: Navigate to the Event Viewer through the Start menu.
- **Security Logs**: In the Event Viewer, drill down into "Windows Logs" and select "Security" to view auditing logs.

##### **Interpreting Security Logs**
- **Audit Failures**: Look for audit failure entries that indicate unsuccessful logon attempts.
  - **Details**: Investigate the failed logon attempt to gather details such as the time, account used, and IP address.
  - **Source Network Address**: Identify the IP address from which the failed logon attempt originated.
  - **Workstation Name**: Determine the name of the workstation attempting the logon.

##### **Real-World Example**
- **Example Scenario**:
  - A Windows virtual machine with a public IP address shows multiple audit failures in the security log.
  - Audit entries reveal attempts to log in using the "Administrator" account from unknown IP addresses.
  - The IP addresses and workstation names help identify potential attackers trying to compromise the machine.
  
- **Mitigation**:
  - Avoid assigning public IP addresses to virtual machines unless necessary.
  - Use alternative methods such as VPN connections or jump boxes for secure management of virtual machines.

#### **Best Practices for Auditing**
- **Regular Log Review**: Consistently review audit logs to detect and respond to unauthorized access attempts.
- **Account Separation**: Ensure each user has a unique account to maintain clear audit trails.
- **Environment Hardening**: Use audit logs to identify vulnerabilities and take steps to secure your environment.
## Authentication Methods 
#### **Authentication Methods and Best Practices**

##### **Standard Authentication**
- **Username and Password**
  - **Common Issue**: Both fall into the "something you know" category, making them vulnerable to guessing.
  - **Examples of Weak Passwords**: "123456", "ABC123", "password", or a pet's name.
  - **Password Reuse**: Using the same password for multiple resources is risky; if one is compromised, all associated accounts are at risk.

##### **Password Management**
- **Unique and Complex Passwords**
  - **Best Practice**: Use different, complex passwords for every resource.
  - **Challenge**: Remembering multiple complex passwords can be difficult.
- **Password Managers**
  - **Examples**: LastPass, Windows 10 Credential Manager.
  - **Functionality**: Store credentials securely; LastPass uses a master key for access, while Windows 10 Credential Manager is tied to the user account.
  - **Security Concern**: If the master key or user account is compromised, so are the stored credentials.

#### **Multi-Factor Authentication (MFA)**

##### **MFA Overview**
- **Definition**: Using more than one factor to authenticate a user.
- **Common Factors**:
  - **Something You Know**: Passwords, PINs.
  - **Something You Have**: Smartcards, RSA tokens, OTPs.
  - **Something You Are**: Biometrics like fingerprints, facial recognition.

##### **One-Time Passwords (OTP)**
- **Definition**: A unique password or code that is valid for a single session or transaction.
- **Time-Based OTP (TOTP)**
  - **Function**: The code is only valid for a short period (e.g., 30 seconds).
  - **Use Case**: Often sent via SMS, email, or generated by an authenticator app.
- **HMAC-Based OTP (HOTP)**
  - **Security**: Uses HMAC (Hash-Based Message Authentication Code) to ensure the integrity of the code.

##### **Smartcards and PKI Certificates**
- **Smartcards**
  - **Description**: Credit card-sized cards that store digital certificates.
  - **Usage**: Used for authentication to buildings, computers, VPNs, etc.
- **PKI Certificates**
  - **Description**: Digital certificates issued by a trusted authority to authenticate users, devices, or software.
  - **Storage**: Can be embedded in smartcards or stored on devices.

#### **Biometric Authentication**

##### **Biometric Factors**
- **Types of Biometrics**:
  - **Fingerprint Scans**: Common on laptops, smartphones.
  - **Retinal and Iris Scans**: Analyze unique patterns in the eye.
  - **Facial Recognition**: Popular on devices like Apple iOS.
  - **Voice Recognition**: Analyzes voice patterns.
  - **Vein Analysis**: Uses unique vein patterns in limbs.
  - **Gait Analysis**: Identifies individuals by their walking pattern.

##### **Challenges in Biometrics**
- **False Acceptance Rate (FAR)**: Incorrectly matching an individual to the biometric data.
- **False Rejection Rate (FRR)**: Failing to match the correct individual to the biometric data.
- **Crossover Error Rate (CER)**: The point where the FAR and FRR are equal; used to measure the accuracy of the biometric system.

#### **SSH Public Key Authentication**
- **Overview**: Enhances security by using a pair of cryptographic keys.
  - **Public Key**: Stored on the server.
  - **Private Key**: Stored on the user's device, protected by a passphrase.
- **Usage**: Often used for secure logins to network devices or servers without requiring a password for the user account.
## Access Control Schemes 
#### **Access Control Concepts**

##### **Authentication and Authorization**
- **Authentication**: Proving identity for a user, device, or software component.
- **Authorization**: Granting permissions to access resources after successful authentication.

##### **Credential Policies**
- **Internal Employees**: Assigning permissions within the organization.
- **Contractors**: Policies for temporary workers requiring resource access.
- **Devices**: Policies determining which devices can access the network, especially through VPNs.
- **Service Accounts**:
  - **Definition**: Fake user accounts used to assign permissions to software components.
  - **Example**: Managed identities in Microsoft Azure for virtual machines.
- **Privileged Access Management (PAM)**: Controlling access for administrative or root accounts.

#### **Access Control Schemes**

##### **Attribute-Based Access Control (ABAC)**
- **Definition**: Permissions are granted based on attributes of a user or device.
- **Examples**:
  - **User Attributes**: Using date of birth to determine eligibility for certain services.
  - **Device Attributes**: Allowing access based on the operating system (e.g., Apple iOS).

##### **Role-Based Access Control (RBAC)**
- **Definition**: Permissions are grouped into roles that can be assigned to users or devices.
- **Functionality**:
  - **Roles**: Collections of related permissions (e.g., read access to files).
  - **Assignments**: Users or devices are assigned to roles to inherit permissions.

##### **Rule-Based Access Control (RBAC)**
- **Definition**: Access is granted based on a set of conditions that must be met.
- **Conditional Access Policies**:
  - **Examples**:
    - **MFA Requirement**: Must be signed in using multi-factor authentication.
    - **Device Type**: Access is allowed only from specific device types (e.g., Apple iOS).
    - **Geolocation**: Access is granted if the user is signing in from a specific location (e.g., Canada).

##### **Mandatory Access Control (MAC)**
- **Definition**: Operating system-enforced access control based on labels or identifiers.
- **Applications**:
  - **High-Security Environments**: Used in systems like Security-Enhanced Linux (SE Linux) or SE Android.
  - **Policy Enforcement**: The OS enforces access based on security clearances and labeled resources.

##### **Discretionary Access Control (DAC)**
- **Definition**: Access control where users set permissions on files or folders at their discretion.
- **Functionality**:
  - **Data Custodian Role**: Users set permissions to align with policies set by the data owner.

##### **Physical Access Control**
- **Definition**: Control of physical access to buildings and sensitive areas.
- **Examples**:
  - **Building Security**: Locked doors, security guards, and access control vestibules.
  - **Server Room Security**: Locks on server room doors and equipment racks.
  - **Multiple Levels of Security**: Ensuring physical security complements digital security measures.
## Account Management
#### **Authentication and Authorization Management**

##### **Authentication**
- **Proving Identity**: Users authenticate by signing in with unique credentials.
- **Importance of Unique Credentials**:
  - **Accountability**: Each user must have a separate account to ensure accountability.
  - **Avoid Shared Credentials**: Sharing usernames and passwords among users is a security risk.

##### **Authorization**
- **Permission Assignment**:
  - **User Groups**: Users are organized into groups with similar requirements for easier management.
  - **Principle of Least Privilege**: Assign only the necessary permissions required to perform a task.
  - **Administrative Laziness**: Avoid adding users to high-privilege groups (e.g., Administrators) without proper need.

#### **Account Auditing and Management**

##### **Account Auditing**
- **Failed Login Attempts**: Track failed attempts as they may indicate an attack or a user forgetting their password.
- **Account Offboarding**:
  - **Disabling Accounts**: Disable accounts rather than deleting them immediately when an employee leaves.
  - **Retaining Data**: Keep the data related to the user account for a period as per organizational policy.

##### **Account Creation and Management**
- **User Accounts**:
  - **Creating User Accounts**: Assign necessary permissions while adhering to the principle of least privilege.
  - **Multi-Factor Authentication**: Essential for administrative accounts like "Administrator" or "root."
- **Device Accounts**:
  - **Joining Devices to a Domain**: For policy management and access control.
  - **Conditional Access**: Devices must be registered to be allowed access.
- **Service Accounts**:
  - **Definition**: Accounts used for running services or software.
- **Guest Accounts**:
  - **Limited Access**: Used for contractors with restricted access to resources.

#### **Permissions and Access Control**

##### **AWS Identity and Access Management (IAM)**
- **User Creation**:
  - **Example**: Create user accounts in AWS and assign them to groups with specific permissions.
  - **Password Policies**: Set policies like mandatory password resets and password complexity requirements.
- **Group Management**:
  - **Assigning Permissions**: Attach policies to groups for easier management.
  - **Reviewing Permissions**: Regularly check group permissions to ensure they align with security policies.

##### **Windows Account Policies**
- **Password Policy**:
  - **Enforcing Password History**: Prevent the reuse of recent passwords.
  - **Password Complexity**: Require complex passwords (e.g., minimum length).
  - **Account Lockout**: Set lockout thresholds to prevent brute force attacks.
- **Geolocation and Geofencing**:
  - **Tracking Access**: Use geolocation to determine if a user should have access.
  - **Impossible Travel Time**: Detect abnormal login locations that are geographically impossible within a short time frame.

##### **Behavior Monitoring**
- **Baseline of Normal Activity**:
  - **Defining Normal Behavior**: Establish what is typical for a user's access patterns.
  - **Identifying Anomalies**: Detect and respond to abnormal activities (e.g., access from unusual locations or times).

## Network Authentication
#### **Network Authentication Protocols**

##### **Legacy Protocols**
- **Password Authentication Protocol (PAP)**
  - **Description**: An older protocol that sends credentials over the network in clear text.
  - **Security Risk**: Vulnerable to interception using tools like Tcpdump or Wireshark.
  - **Recommendation**: Should not be used due to security vulnerabilities.

##### **Microsoft Challenge-Handshake Authentication Protocol (MS-CHAP)**
- **MS-CHAP v2**
  - **Description**: A network authentication protocol that uses a challenge-response mechanism.
  - **Process**:
    - **Client Request**: Client requests authentication from the server.
    - **Server Challenge**: Server sends a challenge to the client.
    - **Client Response**: Client responds with a hash of the user's password.
    - **Server Verification**: Server compares the hash to authenticate the user.
  - **Security**: Transmits password hashes instead of clear text passwords.

##### **New Technology LAN Manager (NTLM)**
- **NTLM v2**
  - **Usage**: Used in Windows workgroup environments where computers are not part of an Active Directory domain.
  - **Security**:
    - **Password Hashes**: NTLM v2 uses salted password hashes, making them difficult to crack.
    - **Workgroup Computers**: Commonly used on standalone computers managed individually.

##### **Kerberos**
- **Usage**: The primary network authentication protocol used in Active Directory environments.
- **Components**:
  - **Key Distribution Center (KDC)**
  - **Authentication Service (AS)**
  - **Ticket Granting Service (TGS)**
  - **Ticket Granting Ticket (TGT)**
- **Process**:
  - **Authentication**: Users authenticate and receive a TGT.
  - **Resource Access**: Present the TGT to access resources without re-authenticating.

##### **Extensible Authentication Protocol (EAP)**
- **Description**: A standardized framework for network authentication.
- **Applications**:
  - **PKI Certificates**: Can be used for certificate-based authentication.
  - **Smartcards**: Supports smartcard-based authentication.
- **Transport Mechanism**: Often uses Transport Layer Security (TLS) for secure, encrypted communication.
- **Usage**: Applies to both wired and wireless network authentication.

##### **IEEE 802.1X**
- **Description**: A port-based network access control protocol.
- **Function**:
  - **Network Access Control**: Controls who can access the network.
  - **Devices**: Used by network edge devices like Ethernet switches, routers, and VPN concentrators.
  - **Authentication Handoff**: These devices hand off authentication requests to a centralized server.
- **Security**: Prevents unauthorized network access, reducing the risk of internal threats.

##### **RADIUS (Remote Authentication Dial-In User Service)**
- **Description**: A centralized authentication server protocol.
- **Components**:
  - **RADIUS Server**: The centralized server that handles authentication.
  - **RADIUS Client**: The network edge device (e.g., switch, router, VPN appliance) that requests authentication.
  - **RADIUS Supplicant**: The user or device (e.g., smartphone) trying to connect to the network.
- **Security**: Centralizes authentication, reducing the risk of edge device compromise.

##### **TACACS+ and XTACACS**
- **Description**: Variations of the RADIUS protocol.
- **Functionality**: Provides similar centralized authentication services with additional features.

## Identity Management Systems  
#### **Identity Management Environment**

##### **Single Sign-On (SSO)**
- **Overview**: Allows users to sign in once and gain access to multiple applications without re-entering credentials.
- **Protocols**:
  - **OpenID**: An open standard for authentication.
  - **OAuth**: An open authorization framework that enables SSO.
- **Example**: Signing into a website using Google credentials.
  - **Process**:
    - **Step 1**: User selects "Continue with Google."
    - **Step 2**: OAuth2 is referenced in the URL for authorization.
    - **Step 3**: User signs in with Google credentials, potentially using two-step verification.
    - **Outcome**: User is authenticated and signed into the site using their Google account.

##### **Identity Federation**
- **Overview**: A system where multiple resource providers trust a single identity provider.
- **Key Components**:
  - **Identity Provider (IDP)**: The centralized trusted source for authentication (e.g., Google, Facebook).
  - **Resource Providers (RPs)**: Websites or services that rely on the IDP for authentication.
- **Protocols**:
  - **OAuth2**: Used for authorization in Identity Federation.
  - **SAML (Security Assertion Markup Language)**:
    - **Function**: SAML tokens are digital security tokens proving user identity.
    - **Process**:
      - **Step 1**: User connects to a web app (resource provider).
      - **Step 2**: Resource provider redirects the user to the IDP.
      - **Step 3**: User authenticates with the IDP.
      - **Step 4**: IDP sends a signed SAML token back to the user.
      - **Step 5**: User presents the SAML token to the resource provider, gaining access.

##### **Applications of Identity Federation**
- **On-Premises Solutions**:
  - **Microsoft Active Directory Federation Services (ADFS)**: Enables Identity Federation within an organization.
  - **Third-Party Solutions**:
    - **Shibboleth**: An open-source Identity Federation solution.
- **Internet Use**: Widely implemented across websites, allowing users to authenticate using trusted providers like Google or Facebook.

##### **Integration in Identity Management Systems**
- **Centralization**: Identity management systems centralize authentication, authorization, and network authentication protocols.
- **Transparency to Users**: Users experience seamless access to resources, often without needing to re-authenticate.



